<!--
 * Copyright (c) 2015 Mountainstorm
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 * Original from https://github.com/mountainstorm/jquery.graphviz.svg/blob/master/demo.html
 -->
<html>
	<head>
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.4/css/bootstrap.min.css">
        <!-- <link rel="stylesheet" href="css/graphviz.svg.css"> -->
        <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.3/styles/default.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.3/highlight.min.js"></script>
	</head>

	<style>
        #instructions {
            color: #000000;
            position: absolute;
            z-index: 100;
            bottom: 0px;
            left: 0px;
        }
    </style>
	<body>
		<h4 id="instructions">Click node to highlight; Shift-scroll to zoom; Esc to unhighlight</h4>
		<div id="graph" style="width: 100%; height: 100%; overflow: scroll;"></div>

		<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
		<script type="text/javascript" src="https://cdn.rawgit.com/jquery/jquery-mousewheel/master/jquery.mousewheel.min.js"></script>
		<script type="text/javascript" src="https://cdn.rawgit.com/jquery/jquery-color/master/jquery.color.js"></script>
		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.4/js/bootstrap.min.js"></script>
		<script type = "text/javascript" > ! function(t) {
            "use strict";
            String.prototype.startsWith = function(t) {
                return 0 == this.indexOf(t)
            }, String.prototype.endsWith = function(t) {
                return -1 !== this.indexOf(t, this.length - t.length)
            };
            var e = function(t, e) {
                this.type = null, this.options = null, this.enabled = null, this.$element = null, this.init("graphviz.svg", t, e)
            };
            e.VERSION = "1.0.1", e.GVPT_2_PX = 32.5, e.DEFAULTS = {
                url: null,
                svg: null,
                shrink: "0.125pt",
                tooltips: {
                    init: function(e) {
                        var i = t(this);
                        i.tooltip({
                            container: e,
                            placement: "auto left",
                            animation: !1,
                            viewport: null
                        }).on("hide.bs.tooltip", function() {
                            if (i.attr("data-tooltip-keepvisible")) return !1
                        })
                    },
                    show: function() {
                        var e = t(this);
                        e.attr("data-tooltip-keepvisible", !0), e.tooltip("show")
                    },
                    hide: function() {
                        var e = t(this);
                        e.removeAttr("data-tooltip-keepvisible"), e.tooltip("hide")
                    },
                    update: function() {
                        var e = t(this);
                        e.attr("data-tooltip-keepvisible") && e.tooltip("show")
                    }
                },
                zoom: !0,
                highlight: {
                    selected: function(t, e) {
                        return t
                    },
                    unselected: function(t, e) {
                        return jQuery.Color(t).transition(e, .9)
                    }
                },
                ready: null
            }, e.prototype.init = function(e, i, n) {
                if (this.enabled = !0, this.type = e, this.$element = t(i), this.options = this.getOptions(n), n.url) {
                    var o = this;
                    t.get(n.url, null, function(e) {
                        var i = t("svg", e);
                        o.$element.html(document.adoptNode(i[0])), o.setup()
                    }, "xml")
                } else n.svg && this.$element.html(n.svg), this.setup()
            }, e.prototype.getDefaults = function() {
                return e.DEFAULTS
            }, e.prototype.getOptions = function(e) {
                return (e = t.extend({}, this.getDefaults(), this.$element.data(), e)).shrink && ("object" != typeof e.shrink && (e.shrink = {
                    x: e.shrink,
                    y: e.shrink
                }), e.shrink.x = this.convertToPx(e.shrink.x), e.shrink.y = this.convertToPx(e.shrink.y)), e
            }, e.prototype.setup = function() {
                var e = this.options,
                    i = t(this.$element.children("svg")),
                    n = i.children("g:first");
                this.$svg = i, this.$graph = n, this.$background = n.children("polygon:first"), this.$nodes = n.children(".node"), this.$edges = n.children(".edge"), this._nodesByName = {}, this._edgesByName = {}, this.$element.addClass("graphviz-svg"), this.$background.length && this.$element.css("background", this.$background.attr("fill"));
                var o = this;
                this.$nodes.each(function() {
                    o.setupNodesEdges(t(this), !0)
                }), this.$edges.each(function() {
                    o.setupNodesEdges(t(this), !1)
                });
                var r = this.$graph.children("title");
                this.$graph.attr("data-name", r.text()), r.remove(), e.zoom && this.setupZoom(), e.ready && e.ready.call(this)
            }, e.prototype.setupNodesEdges = function(e, i) {
                var n = this,
                    o = this.options;
                e.find("polygon, ellipse, path").each(function() {
                    var e = t(this);
                    e.data("graphviz.svg.color", {
                        fill: e.attr("fill"),
                        stroke: e.attr("stroke")
                    }), i && o.shrink && n.scaleNode(e)
                });
                var r, s, h = e.children("title");
                if (h[0]) {
                    var a = h.text().replace(/:[snew][ew]?/g, "");
                    e.attr("data-name", a), h.remove(), i ? this._nodesByName[a] = e[0] : this._edgesByName[a] = e[0];
                    for (var l = e[0].previousSibling; l && 8 != l.nodeType;) l = l.previousSibling;
                    if (null != l && 8 == l.nodeType) {
                        var p = (r = l.nodeValue.trim(), (s = document.createElement("div")).innerHTML = r, s.childNodes[0].nodeValue);
                        p != a && e.attr("data-comment", p)
                    }
                }
                e.children("a").filter(function() {
                    return t(this).attr("xlink:title")
                }).each(function() {
                    var e = t(this);
                    e.attr("title", e.attr("xlink:title")), e.removeAttr("xlink:title"), o.tooltips && o.tooltips.init.call(this, n.$element)
                })
            }, e.prototype.setupZoom = function() {
                var t = this,
                    e = this.$element,
                    i = this.$svg;
                this.zoom = {
                    width: i.attr("width"),
                    height: i.attr("height"),
                    percentage: null
                }, this.scaleView(100), e.mousewheel(function(n) {
                    if (n.shiftKey) {
                        var o = t.zoom.percentage;
                        (o -= n.deltaY * n.deltaFactor) < 100 && (o = 100);
                        var r = n.pageX - i.offset().left,
                            s = n.pageY - i.offset().top,
                            h = r / i.width(),
                            a = s / i.height(),
                            l = n.pageX - e.offset().left,
                            p = n.pageY - e.offset().top;
                        return t.scaleView(o), e.scrollLeft(h * i.width() + .5 - l), e.scrollTop(a * i.height() + .5 - p), !1
                    }
                })
            }, e.prototype.scaleView = function(t) {
                var e = this,
                    i = this.$svg;
                i.attr("width", t + "%"), i.attr("height", t + "%"), this.zoom.percentage = t, this.$nodes.add(this.$edges).children("a[title]").each(function() {
                    e.options.tooltips.update.call(this)
                })
            }, e.prototype.scaleNode = function(t) {
                var e = this.options.shrink.x,
                    i = this.options.shrink.y,
                    n = t.prop("tagName");
                if ("ellipse" == n) t.attr("rx", parseFloat(t.attr("rx")) - e), t.attr("ry", parseFloat(t.attr("ry")) - i);
                else if ("polygon" == n) {
                    var o = t[0].getBBox(),
                        r = o.x + o.width / 2,
                        s = o.y + o.height / 2,
                        h = t.attr("points").split(" "),
                        a = "";
                    for (var l in h) {
                        var p = h[l].split(","),
                            d = parseFloat(p[0]),
                            u = parseFloat(p[1]);
                        a += (r - d) / (o.width / 2) * e + d + "," + ((s - u) / (o.height / 2) * i + u) + " "
                    }
                    t.attr("points", a)
                }
            }, e.prototype.convertToPx = function(t) {
                var i = t;
                if ("string" == typeof t) {
                    var n = t.length,
                        o = 1;
                    t.endsWith("px") ? n -= 2 : t.endsWith("pt") && (n -= 2, o = e.GVPT_2_PX), i = parseFloat(t.substring(0, n)) * o
                }
                return i
            }, e.prototype.findEdge = function(t, e, i) {
                var n = [];
                for (var o in this._edgesByName) {
                    var r = e(t, o);
                    r && (i && i.push(this._edgesByName[o]), n.push(r))
                }
                return n
            }, e.prototype.findLinked = function(e, i, n, o) {
                var r = t(e),
                    s = null;
                i && (s = o);
                var h = this.findEdge(r.attr("data-name"), n, s);
                for (var a in h) {
                    var l = this._nodesByName[h[a]];
                    o.is(l) || (o.push(l), this.findLinked(l, i, n, o))
                }
            }, e.prototype.colorElement = function(e, i) {
                var n = this.$element.css("background");
                e.find("polygon, ellipse, path").each(function() {
                    var e = t(this),
                        o = e.data("graphviz.svg.color");
                    o.fill && "path" != e.prop("tagName") && e.attr("fill", i(o.fill, n)), o.stroke && e.attr("stroke", i(o.stroke, n))
                })
            }, e.prototype.restoreElement = function(e) {
                e.find("polygon, ellipse, path").each(function() {
                    var e = t(this),
                        i = e.data("graphviz.svg.color");
                    i.fill && e.attr("fill", i.fill), i.stroke && e.attr("stroke", i.stroke)
                })
            }, e.prototype.nodes = function() {
                return this.$nodes
            }, e.prototype.edges = function() {
                return this.$edges
            }, e.prototype.nodesByName = function() {
                return this._nodesByName
            }, e.prototype.edgesByName = function() {
                return this._edgesByName
            }, e.prototype.linkedTo = function(e, i) {
                var n = t();
                return this.findLinked(e, i, function(t, e) {
                    var i = null,
                        n = "->" + t;
                    return e.endsWith(n) && (i = e.substring(0, e.length - n.length)), i
                }, n), n
            }, e.prototype.linkedFrom = function(e, i) {
                var n = t();
                return this.findLinked(e, i, function(t, e) {
                    var i = null,
                        n = t + "->";
                    return e.startsWith(n) && (i = e.substring(n.length)), i
                }, n), n
            }, e.prototype.linked = function(e, i) {
                var n = t();
                return this.findLinked(e, i, function(t, e) {
                    return "^" + name + "--(.*)$"
                }, n), this.findLinked(e, i, function(t, e) {
                    return "^(.*)--" + name + "$"
                }, n), n
            }, e.prototype.tooltip = function(e, i) {
                var n = this.options;
                e.each(function() {
                    t(this).children("a[title]").each(function() {
                        i ? n.tooltips.show.call(this) : n.tooltips.hide.call(this)
                    })
                })
            }, e.prototype.bringToFront = function(t) {
                t.detach().appendTo(this.$graph)
            }, e.prototype.sendToBack = function(t) {
                this.$background.length ? $element.insertAfter(this.$background) : t.detach().prependTo(this.$graph)
            }, e.prototype.highlight = function(e, i) {
                var nodes = this.$nodes;
                console.log("Not Connected Nodes:", nodes.not(e));
                var n = this,
                    o = this.options,
                    r = this.$nodes.add(this.$edges);
                nodes.each(function() {
                    this.style.opacity = '1.0';
                });
                i == true ? (nodes.not(e).each(function() {
                    this.style.opacity = '0.2';
                })) : null;
                e && e.length > 0 ? (r.not(e).each(function() {
                    n.colorElement(t(this), o.highlight.unselected), n.tooltip(t(this))
                }), e.each(function() {
                    n.colorElement(t(this), o.highlight.selected)
                }), i && this.tooltip(e, !0)) : (r.each(function() {
                    n.restoreElement(t(this))
                }), this.tooltip(r))
            }, e.prototype.destroy = function() {
                var t = this;
                this.hide(function() {
                    t.$element.off("." + t.type).removeData(t.type)
                })
            };
            var i = t.fn.graphviz;
            t.fn.graphviz = function(i) {
                return this.each(function() {
                    var n = t(this),
                        o = n.data("graphviz.svg"),
                        r = "object" == typeof i && i;
                    !o && /destroy/.test(i) || (o || n.data("graphviz.svg", o = new e(this, r)), "string" == typeof i && o[i]())
                })
            }, t.fn.graphviz.Constructor = e, t.fn.graphviz.noConflict = function() {
                return t.fn.graphviz = i, this
            }
        }(jQuery); 
        </script>
		<script type="text/javascript">
            // Function to calculate the line height
            function calculateLineHeight(windowObj) {
                var dummyElement = windowObj.document.createElement('span');
                dummyElement.innerHTML = 'X'; // Use a single character for measurement
                dummyElement.style.visibility = 'hidden';
                dummyElement.style.position = 'absolute';
                dummyElement.style.fontSize = '1rem'; // Set font size to calculate line height
                dummyElement.style.lineHeight = '1'; // Reset line height to default
                windowObj.document.body.appendChild(dummyElement);
                var lineHeight = dummyElement.offsetHeight;
                windowObj.document.body.removeChild(dummyElement);
                return lineHeight;
            }
 			$(document).ready(function(){
                $("#graph").graphviz({
                    svg: `<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">

<!-- Generated by graphviz version 2.50.0 (0)
 -->
<!-- Title: G Pages: 1 -->
<svg height="1006pt" viewbox="0.00 0.00 1154.00 1006.00" width="1154pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g class="graph" id="graph0" transform="scale(1 1) rotate(0) translate(4 1002)">
<title>G</title>
<polygon fill="white" points="-4,4 -4,-1002 1150,-1002 1150,4 -4,4" stroke="transparent"></polygon>
<g class="cluster" id="clust3">
<title>cluster_8303d966</title>
<polygon fill="none" points="8,-8 8,-990 1008,-990 1008,-8 8,-8" stroke="black" stroke-dasharray="1,5"></polygon>
<text font-family="Times New Roman,serif" font-size="14.00" text-anchor="middle" x="508" y="-974.8">File: script05b57308bf18455eaefaba660f59f2b8</text>
</g>
<g class="cluster" id="clust4">
<title>cluster_8fdffe41</title>
<polygon fill="none" points="16,-16 16,-959 1000,-959 1000,-16 16,-16" stroke="black" stroke-dasharray="1,5"></polygon>
<text font-family="Times New Roman,serif" font-size="14.00" text-anchor="middle" x="508" y="-943.8">Class: Gr8Script8600b27ff9ad4a768a6935d9c6b2ac47</text>
</g>
<g class="cluster" id="clust1">
<title>cluster_f537ab0b</title>
<polygon fill="none" points="1016,-8 1016,-176 1138,-176 1138,-8 1016,-8" stroke="black" stroke-dasharray="1,5"></polygon>
<text font-family="Times New Roman,serif" font-size="14.00" text-anchor="middle" x="1077" y="-160.8">File: ktgfunc</text>
</g>
<g class="cluster" id="clust2">
<title>cluster_04044780</title>
<polygon fill="none" points="1024,-16 1024,-145 1130,-145 1130,-16 1024,-16" stroke="black" stroke-dasharray="1,5"></polygon>
<text font-family="Times New Roman,serif" font-size="14.00" text-anchor="middle" x="1077" y="-129.8">Class: Algo</text>
</g>
<!-- node_15b42a97 -->
<g class="node" id="node1">
<title>node_15b42a97</title>
<path d="M1110,-60C1110,-60 1044,-60 1044,-60 1038,-60 1032,-54 1032,-48 1032,-48 1032,-36 1032,-36 1032,-30 1038,-24 1044,-24 1044,-24 1110,-24 1110,-24 1116,-24 1122,-30 1122,-36 1122,-36 1122,-48 1122,-48 1122,-54 1116,-60 1110,-60" fill="#6db33f" stroke="black"></path>
<text font-family="Times New Roman,serif" font-size="14.00" text-anchor="middle" x="1077" y="-38.3">2: algo_buy()</text>
<text style="display:none;">def algo_buy(self, symbol, voodooGuid, type, order_quantity, price, user_key):
    return 1</text></g>
<!-- node_7a6844ec -->
<g class="node" id="node2">
<title>node_7a6844ec</title>
<path d="M1109.5,-114C1109.5,-114 1044.5,-114 1044.5,-114 1038.5,-114 1032.5,-108 1032.5,-102 1032.5,-102 1032.5,-90 1032.5,-90 1032.5,-84 1038.5,-78 1044.5,-78 1044.5,-78 1109.5,-78 1109.5,-78 1115.5,-78 1121.5,-84 1121.5,-90 1121.5,-90 1121.5,-102 1121.5,-102 1121.5,-108 1115.5,-114 1109.5,-114" fill="#6db33f" stroke="black"></path>
<text font-family="Times New Roman,serif" font-size="14.00" text-anchor="middle" x="1077" y="-92.3">4: algo_sell()</text>
<text style="display:none;">def algo_sell(self, symbol, voodooGuid, types, price, order_quantity, allow_multiple_pending, user_key):
    return 1</text></g>
<!-- node_3b3e14e3 -->
<g class="node" id="node3">
<title>node_3b3e14e3</title>
<path d="M854.5,-655C854.5,-655 741.5,-655 741.5,-655 735.5,-655 729.5,-649 729.5,-643 729.5,-643 729.5,-631 729.5,-631 729.5,-625 735.5,-619 741.5,-619 741.5,-619 854.5,-619 854.5,-619 860.5,-619 866.5,-625 866.5,-631 866.5,-631 866.5,-643 866.5,-643 866.5,-649 860.5,-655 854.5,-655" fill="#cccccc" stroke="black"></path>
<text font-family="Times New Roman,serif" font-size="14.00" text-anchor="middle" x="798" y="-633.3">2639: algo_buy_exit()</text>
<text style="display:none;">def algo_buy_exit(self, md, order, service, account):
    sErr = STRING_SUCCESS
    try:
        if account[md.symbol].position.shares &gt;= 0:
            return
        if self.is_order_sell_decrease_placed:
            return
        order.cancel(self.symbol)
        self.order_id = ''
        self.algo_type = BUY_LIMIT_IEX_AT_SCRIPT_PRICE_STANDARD
        self.algo_intent = 'exit'
        self.price = md.L1.last
        self.order_price = self.price * (1 + self.bid_price_buy_exit_delta_coeff)
        self.order_id = order.algo_buy(md.symbol, self.algo_type, intent='exit', price=self.order_price)
        if self.order_id != '':
            self.order_id_sell_decrease = self.order_id
            self.is_order_sell_decrease_placed = True
        msg = 'algo_buy_exit  order_id= {p_order_id}  algorithm= {p_algorithm}  intent= {p_intent}  price={p_price}'.format(p_order_id=self.order_id, p_algorithm=self.algo_type, p_intent=self.algo_intent, p_price=self.order_price)
        type(self).tracer_0.trace(md.symbol, 'algo_buy_exit', sErr, msg)
    except Exception as X:
        sErr = STRING_FAILED
        msg = traceback.format_exc()
        type(self).tracer_0.trace(md.symbol, 'algo_buy_exit', sErr, msg)</text></g>
<!-- node_3b3e14e3&#45;&gt;node_15b42a97 -->
<g class="edge" id="edge1">
<title>node_3b3e14e3-&gt;node_15b42a97</title>
<path d="M866.6,-637C901.23,-637 936,-637 936,-637 936,-637 936,-48 936,-48 936,-48 1022,-48 1022,-48" fill="none" stroke="#009e73" stroke-width="2"></path>
<polygon fill="#009e73" points="1022,-51.5 1032,-48 1022,-44.5 1022,-51.5" stroke="#009e73" stroke-width="2"></polygon>
</g>
<!-- node_c03ad271 -->
<g class="node" id="node4">
<title>node_c03ad271</title>
<path d="M182,-60C182,-60 45,-60 45,-60 39,-60 33,-54 33,-48 33,-48 33,-36 33,-36 33,-30 39,-24 45,-24 45,-24 182,-24 182,-24 188,-24 194,-30 194,-36 194,-36 194,-48 194,-48 194,-54 188,-60 182,-60" fill="#966f33" stroke="black"></path>
<text font-family="Times New Roman,serif" font-size="14.00" text-anchor="middle" x="113.5" y="-38.3">2357: algo_buy_increase()</text>
<text style="display:none;">def algo_buy_increase(self, md, order, service, account):
    sErr = STRING_SUCCESS
    try:
        if account[md.symbol].pending.shares_long != 0:
            return
        if account[md.symbol].position.shares != 0:
            return
        if self.is_order_buy_increase_placed:
            return
        self.order_id = ''
        self.algo_type = BUY_LIMIT_IEX_AT_SCRIPT_PRICE_STANDARD
        self.algo_intent = 'increase'
        self.price = md.L1.last
        self.order_price = self.price * (1 + self.bid_price_buy_increase_delta_coeff)
        self.shares_buying_power_per_order = self.buying_power_per_order / self.price
        self.order_quantity = int(min(self.shares_buying_power_per_order, self.shares_per_order))
        self.allow_multiple_pending = False
        if not self.is_stop_price_down_buy_set:
            self.stop_price_down_buy = self.price * (1 - self.stop_price_init_interval_coeff_down_buy)
        self.order_id = order.algo_buy(md.symbol, self.algo_type, intent='increase', price=self.order_price, order_quantity=self.order_quantity, allow_multiple_pending=False)
        if self.order_id != '':
            self.order_id_buy_increase = self.order_id
            self.is_order_buy_increase_placed = True
        msg = 'algo_buy  order_id= {p_order_id}  algorithm= {p_algorithm}  intent= {p_intent}  order_quantity={p_order_quantity}  price={p_price}  allow_multiple_pending={p_allow_multiple_pending}'.format(p_order_id=self.order_id, p_algorithm=self.algo_type, p_intent=self.algo_intent, p_order_quantity=self.order_quantity, p_price=self.order_price, p_allow_multiple_pending=self.allow_multiple_pending)
        type(self).tracer_0.trace(md.symbol, 'algo_buy_increase', sErr, msg)
    except Exception as X:
        sErr = STRING_FAILED
        msg = traceback.format_exc()
        type(self).tracer_0.trace(md.symbol, 'algo_buy_increase', sErr, msg)</text></g>
<!-- node_c03ad271&#45;&gt;node_15b42a97 -->
<g class="edge" id="edge2">
<title>node_c03ad271-&gt;node_15b42a97</title>
<path d="M114,-60.16C114,-65.04 114,-69 114,-69 114,-69 1077,-69 1077,-69 1077,-69 1077,-68.12 1077,-68.12" fill="none" stroke="#e69f00" stroke-width="2"></path>
<polygon fill="#e69f00" points="1080.5,-70.16 1077,-60.16 1073.5,-70.16 1080.5,-70.16" stroke="#e69f00" stroke-width="2"></polygon>
</g>
<!-- node_3802d94e -->
<g class="node" id="node5">
<title>node_3802d94e</title>
<path d="M853.5,-60C853.5,-60 742.5,-60 742.5,-60 736.5,-60 730.5,-54 730.5,-48 730.5,-48 730.5,-36 730.5,-36 730.5,-30 736.5,-24 742.5,-24 742.5,-24 853.5,-24 853.5,-24 859.5,-24 865.5,-30 865.5,-36 865.5,-36 865.5,-48 865.5,-48 865.5,-54 859.5,-60 853.5,-60" fill="#cccccc" stroke="black"></path>
<text font-family="Times New Roman,serif" font-size="14.00" text-anchor="middle" x="798" y="-38.3">2306: algo_buy_init()</text>
<text style="display:none;">def algo_buy_init(self, md, order, service, account):
    sErr = STRING_SUCCESS
    try:
        if account[md.symbol].pending.shares_long != 0:
            return
        if account[md.symbol].position.shares != 0:
            return
        if self.is_order_buy_init_placed:
            return
        self.order_id = ''
        self.algo_type = BUY_LIMIT_IEX_AT_SCRIPT_PRICE_STANDARD
        self.algo_intent = 'init'
        self.price = md.L1.last
        self.order_price = self.price * (1 + self.bid_price_buy_init_delta_coeff)
        self.shares_buying_power_per_order = self.buying_power_per_order / self.price
        self.order_quantity = int(min(self.shares_buying_power_per_order, self.shares_per_order))
        self.allow_multiple_pending = False
        if not self.is_stop_price_down_buy_set:
            self.stop_price_down_buy = self.price * (1 - self.stop_price_init_interval_coeff_down_buy)
        self.order_id = order.algo_buy(md.symbol, self.algo_type, intent='init', price=self.order_price, order_quantity=self.order_quantity, allow_multiple_pending=False)
        if self.order_id != '':
            self.order_id_buy_init = self.order_id
            self.is_order_buy_init_placed = True
        msg = 'algo_buy  order_id= {p_order_id}  algorithm= {p_algorithm}  intent= {p_intent}  order_quantity={p_order_quantity}  price={p_price}  allow_multiple_pending={p_allow_multiple_pending}'.format(p_order_id=self.order_id, p_algorithm=self.algo_type, p_intent=self.algo_intent, p_order_quantity=self.order_quantity, p_price=self.order_price, p_allow_multiple_pending=self.allow_multiple_pending)
        type(self).tracer_0.trace(md.symbol, 'algo_buy_init', sErr, msg)
    except Exception as X:
        sErr = STRING_FAILED
        msg = traceback.format_exc()
        type(self).tracer_0.trace(md.symbol, 'algo_buy_init', sErr, msg)</text></g>
<!-- node_3802d94e&#45;&gt;node_15b42a97 -->
<g class="edge" id="edge3">
<title>node_3802d94e-&gt;node_15b42a97</title>
<path d="M865.54,-36C865.54,-36 1021.86,-36 1021.86,-36" fill="none" stroke="#d55e00" stroke-width="2"></path>
<polygon fill="#d55e00" points="1021.86,-39.5 1031.86,-36 1021.86,-32.5 1021.86,-39.5" stroke="#d55e00" stroke-width="2"></polygon>
</g>
<!-- node_f9ead294 -->
<g class="node" id="node6">
<title>node_f9ead294</title>
<path d="M854,-709C854,-709 742,-709 742,-709 736,-709 730,-703 730,-697 730,-697 730,-685 730,-685 730,-679 736,-673 742,-673 742,-673 854,-673 854,-673 860,-673 866,-679 866,-685 866,-685 866,-697 866,-697 866,-703 860,-709 854,-709" fill="#cccccc" stroke="black"></path>
<text font-family="Times New Roman,serif" font-size="14.00" text-anchor="middle" x="798" y="-687.3">2594: algo_sell_exit()</text>
<text style="display:none;">def algo_sell_exit(self, md, order, service, account):
    sErr = STRING_SUCCESS
    try:
        if account[md.symbol].position.shares &lt;= 0:
            return
        if self.is_order_buy_decrease_placed:
            return
        order.cancel(self.symbol)
        self.order_id = ''
        self.algo_type = SELL_LIMIT_IEX_AT_SCRIPT_PRICE_STANDARD
        self.algo_intent = 'exit'
        self.price = md.L1.last
        self.order_price = self.price * (1 - self.ask_price_sell_exit_delta_coeff)
        self.order_id = order.algo_sell(md.symbol, self.algo_type, intent='exit', price=self.order_price)
        if self.order_id != '':
            self.order_id_buy_decrease = self.order_id
            self.is_order_buy_decrease_placed = True
        msg = 'algo_sell_exit  order_id= {p_order_id}  algorithm= {p_algorithm}  intent= {p_intent}  price={p_price}'.format(p_order_id=self.order_id, p_algorithm=self.algo_type, p_intent=self.algo_intent, p_price=self.order_price)
        type(self).tracer_0.trace(md.symbol, 'algo_sell_exit', sErr, msg)
    except Exception as X:
        sErr = STRING_FAILED
        msg = traceback.format_exc()
        type(self).tracer_0.trace(md.symbol, 'algo_sell_exit', sErr, msg)</text></g>
<!-- node_f9ead294&#45;&gt;node_7a6844ec -->
<g class="edge" id="edge4">
<title>node_f9ead294-&gt;node_7a6844ec</title>
<path d="M866.15,-691C955.22,-691 1100,-691 1100,-691 1100,-691 1100,-124.13 1100,-124.13" fill="none" stroke="#f0e442" stroke-width="2"></path>
<polygon fill="#f0e442" points="1103.5,-124.13 1100,-114.13 1096.5,-124.13 1103.5,-124.13" stroke="#f0e442" stroke-width="2"></polygon>
</g>
<!-- node_c7f590bc -->
<g class="node" id="node7">
<title>node_c7f590bc</title>
<path d="M181.5,-114C181.5,-114 45.5,-114 45.5,-114 39.5,-114 33.5,-108 33.5,-102 33.5,-102 33.5,-90 33.5,-90 33.5,-84 39.5,-78 45.5,-78 45.5,-78 181.5,-78 181.5,-78 187.5,-78 193.5,-84 193.5,-90 193.5,-90 193.5,-102 193.5,-102 193.5,-108 187.5,-114 181.5,-114" fill="#966f33" stroke="black"></path>
<text font-family="Times New Roman,serif" font-size="14.00" text-anchor="middle" x="113.5" y="-92.3">2500: algo_sell_increase()</text>
<text style="display:none;">def algo_sell_increase(self, md, order, service, account):
    sErr = STRING_SUCCESS
    try:
        if account[md.symbol].pending.shares_short != 0:
            return
        if account[md.symbol].position.shares != 0:
            return
        if self.is_order_sell_increase_placed:
            return
        self.order_id = ''
        self.algo_type = SELL_LIMIT_IEX_AT_SCRIPT_PRICE_STANDARD
        self.algo_intent = 'increase'
        self.price = md.L1.last
        self.order_price = self.price * (1 - self.ask_price_sell_increase_delta_coeff)
        self.shares_buying_power_per_order = self.buying_power_per_order / self.price
        self.order_quantity = int(min(self.shares_buying_power_per_order, self.shares_per_order))
        self.allow_multiple_pending = False
        if not self.is_stop_price_up_sell_set:
            self.stop_price_up_sell = self.price * (1 + self.stop_price_init_interval_coeff_up_sell)
        self.order_id = order.algo_sell(md.symbol, self.algo_type, intent='increase', price=self.order_price, order_quantity=self.order_quantity, allow_multiple_pending=False)
        if self.order_id != '':
            self.order_id_sell_increase = self.order_id
            self.is_order_sell_increase_placed = True
        msg = 'algo_sell  order_id= {p_order_id}  algorithm= {p_algorithm}  intent= {p_intent}  order_quantity={p_order_quantity}  price={p_price}  allow_multiple_pending={p_allow_multiple_pending}'.format(p_order_id=self.order_id, p_algorithm=self.algo_type, p_intent=self.algo_intent, p_order_quantity=self.order_quantity, p_price=self.order_price, p_allow_multiple_pending=self.allow_multiple_pending)
        type(self).tracer_0.trace(md.symbol, 'algo_sell_increase', sErr, msg)
    except Exception as X:
        sErr = STRING_FAILED
        msg = traceback.format_exc()
        type(self).tracer_0.trace(md.symbol, 'algo_sell_increase', sErr, msg)</text></g>
<!-- node_c7f590bc&#45;&gt;node_7a6844ec -->
<g class="edge" id="edge5">
<title>node_c7f590bc-&gt;node_7a6844ec</title>
<path d="M114,-114.16C114,-119.04 114,-123 114,-123 114,-123 1055,-123 1055,-123 1055,-123 1055,-122.12 1055,-122.12" fill="none" stroke="#f0e442" stroke-width="2"></path>
<polygon fill="#f0e442" points="1058.5,-124.16 1055,-114.16 1051.5,-124.16 1058.5,-124.16" stroke="#f0e442" stroke-width="2"></polygon>
</g>
<!-- node_5a11f6bf -->
<g class="node" id="node8">
<title>node_5a11f6bf</title>
<path d="M853,-168C853,-168 743,-168 743,-168 737,-168 731,-162 731,-156 731,-156 731,-144 731,-144 731,-138 737,-132 743,-132 743,-132 853,-132 853,-132 859,-132 865,-138 865,-144 865,-144 865,-156 865,-156 865,-162 859,-168 853,-168" fill="#cccccc" stroke="black"></path>
<text font-family="Times New Roman,serif" font-size="14.00" text-anchor="middle" x="798" y="-146.3">2449: algo_sell_init()</text>
<text style="display:none;">def algo_sell_init(self, md, order, service, account):
    sErr = STRING_SUCCESS
    try:
        if account[md.symbol].pending.shares_short != 0:
            return
        if account[md.symbol].position.shares != 0:
            return
        if self.is_order_sell_init_placed:
            return
        self.order_id = ''
        self.algo_type = SELL_LIMIT_IEX_AT_SCRIPT_PRICE_STANDARD
        self.algo_intent = 'init'
        self.price = md.L1.last
        self.order_price = self.price * (1 - self.ask_price_sell_init_delta_coeff)
        self.shares_buying_power_per_order = self.buying_power_per_order / self.price
        self.order_quantity = int(min(self.shares_buying_power_per_order, self.shares_per_order))
        self.allow_multiple_pending = False
        if not self.is_stop_price_up_sell_set:
            self.stop_price_up_sell = self.price * (1 + self.stop_price_init_interval_coeff_up_sell)
        self.order_id = order.algo_sell(md.symbol, self.algo_type, intent='init', price=self.order_price, order_quantity=self.order_quantity, allow_multiple_pending=False)
        if self.order_id != '':
            self.order_id_sell_init = self.order_id
            self.is_order_sell_init_placed = True
        msg = 'algo_sell  order_id= {p_order_id}  algorithm= {p_algorithm}  intent= {p_intent}  order_quantity={p_order_quantity}  price={p_price}  allow_multiple_pending={p_allow_multiple_pending}'.format(p_order_id=self.order_id, p_algorithm=self.algo_type, p_intent=self.algo_intent, p_order_quantity=self.order_quantity, p_price=self.order_price, p_allow_multiple_pending=self.allow_multiple_pending)
        type(self).tracer_0.trace(md.symbol, 'algo_sell_init', sErr, msg)
    except Exception as X:
        sErr = STRING_FAILED
        msg = traceback.format_exc()
        type(self).tracer_0.trace(md.symbol, 'algo_sell_init', sErr, msg)</text></g>
<!-- node_5a11f6bf&#45;&gt;node_7a6844ec -->
<g class="edge" id="edge6">
<title>node_5a11f6bf-&gt;node_7a6844ec</title>
<path d="M865.18,-150C947.74,-150 1077,-150 1077,-150 1077,-150 1077,-124.28 1077,-124.28" fill="none" stroke="#cc79a7" stroke-width="2"></path>
<polygon fill="#cc79a7" points="1080.5,-124.28 1077,-114.28 1073.5,-124.28 1080.5,-124.28" stroke="#cc79a7" stroke-width="2"></polygon>
</g>
<!-- node_e1f2033f -->
<g class="node" id="node9">
<title>node_e1f2033f</title>
<path d="M457.5,-168C457.5,-168 349.5,-168 349.5,-168 343.5,-168 337.5,-162 337.5,-156 337.5,-156 337.5,-144 337.5,-144 337.5,-138 343.5,-132 349.5,-132 349.5,-132 457.5,-132 457.5,-132 463.5,-132 469.5,-138 469.5,-144 469.5,-144 469.5,-156 469.5,-156 469.5,-162 463.5,-168 457.5,-168" fill="#6db33f" stroke="black"></path>
<text font-family="Times New Roman,serif" font-size="14.00" text-anchor="middle" x="403.5" y="-146.3">604: create_alerters()</text>
<text style="display:none;">@classmethod
def create_alerters(cls, service):
    bErr = True
    sErr = STRING_SUCCESS
    try:
        if cls.enable_alerter_0:
            cls.alerter_0 = CTestAlerter(service, aktpdtrprm_plf.ALERT_GUID_001, 3)
            cls.alerter_0.SetMessageField_IDs([aktpdtrprm_plf.ALERT_FIELD_date_time, aktpdtrprm_plf.ALERT_FIELD_entry_signal, aktpdtrprm_plf.ALERT_FIELD_last_price, aktpdtrprm_plf.ALERT_FIELD_alert_message_001])
        if cls.enable_alerter_1:
            cls.alerter_1 = CTestAlerter(service, aktpdtrprm_plf.ALERT_GUID_002, 3)
            cls.alerter_1.SetMessageField_IDs([aktpdtrprm_plf.ALERT_FIELD_date_time, aktpdtrprm_plf.ALERT_FIELD_entry_signal, aktpdtrprm_plf.ALERT_FIELD_last_price, aktpdtrprm_plf.ALERT_FIELD_alert_message_002])
        if cls.enable_alerter_2:
            cls.alerter_2 = CTestAlerter(service, aktpdtrprm_plf.ALERT_GUID_003, 3)
            cls.alerter_2.SetMessageField_IDs([aktpdtrprm_plf.ALERT_FIELD_date_time, aktpdtrprm_plf.ALERT_FIELD_shares, aktpdtrprm_plf.ALERT_FIELD_last_price, aktpdtrprm_plf.ALERT_FIELD_intent, aktpdtrprm_plf.ALERT_FIELD_actual_direction, aktpdtrprm_plf.ALERT_FIELD_note])
        if cls.enable_alerter_3:
            cls.alerter_3 = CTestAlerter(service, aktpdtrprm_plf.ALERT_GUID_004, 3)
            cls.alerter_3.SetMessageField_IDs([aktpdtrprm_plf.ALERT_FIELD_date_time, aktpdtrprm_plf.ALERT_FIELD_shares, aktpdtrprm_plf.ALERT_FIELD_last_price, aktpdtrprm_plf.ALERT_FIELD_intent, aktpdtrprm_plf.ALERT_FIELD_actual_direction, aktpdtrprm_plf.ALERT_FIELD_note])
        if cls.enable_alerter_this_script:
            cls.alerter_this_script = CTestAlerter(service, aktpdtrprm_plf.ALERT_GUID_THIS_SCRIPT, 3)
            cls.alerter_this_script.SetMessageField_IDs([aktpdtrprm_plf.ALERT_FIELD_date_time, aktpdtrprm_plf.ALERT_FIELD_shares, aktpdtrprm_plf.ALERT_FIELD_last_price, aktpdtrprm_plf.ALERT_FIELD_intent, aktpdtrprm_plf.ALERT_FIELD_actual_direction, aktpdtrprm_plf.ALERT_FIELD_note])
    except Exception as X:
        bErr = False
        sErr = STRING_FAILED
        msg = traceback.format_exc()
        cls.tracer_0.trace(SYMBOL_NONE, 'create_alerters', sErr, msg)
    finally:
        cls.tracer_0.trace(SYMBOL_NONE, 'create_alerters', sErr, LEXEM_FINALLY)
        return bErr</text></g>
<!-- node_5749ec83 -->
<g class="node" id="node10">
<title>node_5749ec83</title>
<path d="M878.5,-222C878.5,-222 717.5,-222 717.5,-222 711.5,-222 705.5,-216 705.5,-210 705.5,-210 705.5,-198 705.5,-198 705.5,-192 711.5,-186 717.5,-186 717.5,-186 878.5,-186 878.5,-186 884.5,-186 890.5,-192 890.5,-198 890.5,-198 890.5,-210 890.5,-210 890.5,-216 884.5,-222 878.5,-222" fill="#6db33f" stroke="black"></path>
<text font-family="Times New Roman,serif" font-size="14.00" text-anchor="middle" x="798" y="-200.3">1285: estimate_time_interval()</text>
<text style="display:none;">def estimate_time_interval(self, md, order, service, account):
    bErr = True
    sErr = STRING_SUCCESS
    try:
        timestamp_curr = md.L1.timestamp
        enable_trade_entry_estimate = False
        if self.time_trade_entry_start &lt; timestamp_curr and timestamp_curr &lt; self.time_trade_entry_stop:
            enable_trade_entry_estimate = True
        elif self.time_trade_entry_start_bmo &lt; timestamp_curr and timestamp_curr &lt; self.time_trade_entry_stop_bmo:
            if self.enable_trade_entry_market_open_before and self.duration_trade_entry_market_open_before &gt; 0:
                self.time_trade_entry_start = self.time_trade_entry_start_bmo
                self.time_trade_entry_stop = self.time_trade_entry_stop_bmo
                self.duration_trade_max = self.duration_trade_max_market_open_before
                self.index_trade_interval = 1
                enable_trade_entry_estimate = True
        elif self.time_trade_entry_start_amo &lt; timestamp_curr and timestamp_curr &lt; self.time_trade_entry_stop_amo:
            if self.enable_trade_entry_market_open_after and self.duration_trade_entry_market_open_after &gt; 0:
                self.time_trade_entry_start = self.time_trade_entry_start_amo
                self.time_trade_entry_stop = self.time_trade_entry_stop_amo
                self.duration_trade_max = self.duration_trade_max_market_open_after
                self.index_trade_interval = 2
                enable_trade_entry_estimate = True
        elif self.time_trade_entry_start_intra_day &lt; timestamp_curr and timestamp_curr &lt; self.time_trade_entry_stop_intra_day:
            if self.enable_trade_entry_intra_day and self.duration_trade_entry_intra_day &gt; 0:
                self.time_trade_entry_start = self.time_trade_entry_start_intra_day
                self.time_trade_entry_stop = self.time_trade_entry_stop_intra_day
                self.duration_trade_max = self.duration_trade_max_intra_day
                self.index_trade_interval = 3
                enable_trade_entry_estimate = True
        elif self.time_trade_entry_start_bmc &lt; timestamp_curr and timestamp_curr &lt; self.time_trade_entry_stop_bmc:
            if self.enable_trade_entry_market_close_before and self.duration_trade_entry_market_close_before &gt; 0:
                self.time_trade_entry_start = self.time_trade_entry_start_bmc
                self.time_trade_entry_stop = self.time_trade_entry_stop_bmc
                self.duration_trade_max = self.duration_trade_max_market_close_before
                self.index_trade_interval = 4
                enable_trade_entry_estimate = True
        elif self.time_trade_entry_start_amc &lt; timestamp_curr and timestamp_curr &lt; self.time_trade_entry_stop_amc:
            if self.enable_trade_entry_market_close_after and self.duration_trade_entry_market_close_after &gt; 0:
                self.time_trade_entry_start = self.time_trade_entry_start_amc
                self.time_trade_entry_stop = self.time_trade_entry_stop_amc
                self.duration_trade_max = self.duration_trade_max_market_close_after
                self.index_trade_interval = 5
                enable_trade_entry_estimate = True
        else:
            self.duration_trade_max = 0
            enable_trade_entry_estimate = False
            self.index_trade_interval = 0
        self.enable_trade_entry = enable_trade_entry_estimate
    except Exception as X:
        bErr = False
        sErr = STRING_FAILED
        msg = traceback.format_exc()
        type(self).tracer_0.trace(md.symbol, 'estimate_time_interval', sErr, msg)</text></g>
<!-- node_dd4d60f4 -->
<g class="node" id="node11">
<title>node_dd4d60f4</title>
<path d="M867.5,-114C867.5,-114 728.5,-114 728.5,-114 722.5,-114 716.5,-108 716.5,-102 716.5,-102 716.5,-90 716.5,-90 716.5,-84 722.5,-78 728.5,-78 728.5,-78 867.5,-78 867.5,-78 873.5,-78 879.5,-84 879.5,-90 879.5,-90 879.5,-102 879.5,-102 879.5,-108 873.5,-114 867.5,-114" fill="#6db33f" stroke="black"></path>
<text font-family="Times New Roman,serif" font-size="14.00" text-anchor="middle" x="798" y="-92.3">2695: execute_command()</text>
<text style="display:none;">def execute_command(self, md, order, service, account, command=None):
    pass</text></g>
<!-- node_267c6d6e -->
<g class="node" id="node12">
<title>node_267c6d6e</title>
<path d="M532,-222C532,-222 275,-222 275,-222 269,-222 263,-216 263,-210 263,-210 263,-198 263,-198 263,-192 269,-186 275,-186 275,-186 532,-186 532,-186 538,-186 544,-192 544,-198 544,-198 544,-210 544,-210 544,-216 538,-222 532,-222" fill="#cccccc" stroke="black"></path>
<text font-family="Times New Roman,serif" font-size="14.00" text-anchor="middle" x="403.5" y="-200.3">762: get_risk_management_algorithm_params()</text>
<text style="display:none;">@classmethod
def get_risk_management_algorithm_params(cls):
    bErr = True
    sErr = STRING_SUCCESS
    try:
        cls.dir_path_risk_management_algorithm_db = DIR_PATH_PARAMS_THIS_APP
        cls.file_name_risk_management_algorithm_db = cls.file_name_risk_management_algorithm_db_cfg
        cls.risk_management_algorithm_manager = CRiskManagementAlgorithm()
        cls.risk_management_algorithm_manager.set_db_source(cls.dir_path_risk_management_algorithm_db, cls.file_name_risk_management_algorithm_db)
        cls.tracer_0.trace(SYMBOL_NONE, 'get_risk_management_algorithm_params', sErr, 'create risk management algorithm manager : success')
        msg = 'file_path_db =   ' + cls.risk_management_algorithm_manager.file_name_path_db_source
        cls.tracer_0.trace(SYMBOL_NONE, 'get_risk_management_algorithm_params', sErr, msg)
        if cls.risk_management_algorithm_manager.create_memory_db():
            cls.tracer_0.trace(SYMBOL_NONE, 'get_risk_management_algorithm_params', sErr, 'create mem db : success')
            msg = 'is_db_open = {p_is_db_open}'.format(p_is_db_open=cls.risk_management_algorithm_manager.is_db_open)
            cls.tracer_0.trace(SYMBOL_NONE, 'get_risk_management_algorithm_params', sErr, msg)
            cls.dict_risk_management_algorithm_params = cls.risk_management_algorithm_manager.get_risk_management_algorithm_params()
            len_dict = len(cls.dict_risk_management_algorithm_params)
            msg = 'len(cls.dict_risk_management_algorithm_params) = {p_len}'.format(p_len=len_dict)
            cls.tracer_0.trace(SYMBOL_NONE, 'get_risk_management_algorithm_params', sErr, msg)
            if len_dict == 0:
                cls.dict_risk_management_algorithm_params = cls.dict_risk_management_algorithm_params_cfg
        else:
            cls.tracer_0.trace(SYMBOL_NONE, 'get_risk_management_algorithm_params', sErr, 'create mem db : failed')
            cls.dict_risk_management_algorithm_params = cls.dict_risk_management_algorithm_params_cfg
            bErr = False
            sErr = STRING_FAILED
    except Exception as X:
        bErr = False
        sErr = STRING_FAILED
        msg = traceback.format_exc()
        cls.tracer_0.trace(SYMBOL_NONE, 'get_risk_management_algorithm_params', sErr, msg)
    finally:
        cls.tracer_0.trace(SYMBOL_NONE, 'get_risk_management_algorithm_params', sErr, LEXEM_FINALLY)
        return bErr</text></g>
<!-- node_267c6d6e&#45;&gt;node_267c6d6e -->
<g class="edge" id="edge7">
<title>node_267c6d6e-&gt;node_267c6d6e</title>
<path d="M262.97,-204C255.51,-204 251,-204 251,-204 251,-204 251,-177 251,-177 251,-177 556,-177 556,-177 556,-177 556,-204 556,-204 556,-204 554.03,-204 554.03,-204" fill="none" stroke="#d55e00" stroke-width="2"></path>
<polygon fill="#d55e00" points="554.03,-200.5 544.03,-204 554.03,-207.5 554.03,-200.5" stroke="#d55e00" stroke-width="2"></polygon>
</g>
<!-- node_d552820d -->
<g class="node" id="node13">
<title>node_d552820d</title>
<path d="M476.5,-294C476.5,-294 330.5,-294 330.5,-294 324.5,-294 318.5,-288 318.5,-282 318.5,-282 318.5,-270 318.5,-270 318.5,-264 324.5,-258 330.5,-258 330.5,-258 476.5,-258 476.5,-258 482.5,-258 488.5,-264 488.5,-270 488.5,-270 488.5,-282 488.5,-282 488.5,-288 482.5,-294 476.5,-294" fill="#cccccc" stroke="black"></path>
<text font-family="Times New Roman,serif" font-size="14.00" text-anchor="middle" x="403.5" y="-272.3">653: get_symbol_universe()</text>
<text style="display:none;">@classmethod
def get_symbol_universe(cls):
    bErr = True
    sErr = STRING_SUCCESS
    try:
        cls.dir_path_symbol_universe_db = DIR_PATH_PARAMS_THIS_APP
        cls.file_name_symbol_universe_db = cls.file_name_symbol_universe_db_cfg
        cls.symbol_universe_manager = CSymbolUniverse()
        cls.symbol_universe_manager.set_db_source(cls.dir_path_symbol_universe_db, cls.file_name_symbol_universe_db)
        cls.tracer_0.trace(SYMBOL_NONE, 'get_symbol_universe', sErr, 'create symbol universe manager : success')
        msg = 'file_path_db =   ' + cls.symbol_universe_manager.file_name_path_db_source
        cls.tracer_0.trace(SYMBOL_NONE, 'get_symbol_universe', sErr, msg)
        if cls.symbol_universe_manager.create_memory_db():
            cls.tracer_0.trace(SYMBOL_NONE, 'get_symbol_universe', sErr, 'create mem db : success')
            msg = 'is_db_open = {p_is_db_open}'.format(p_is_db_open=cls.symbol_universe_manager.is_db_open)
            cls.tracer_0.trace(SYMBOL_NONE, 'get_symbol_universe', sErr, msg)
            cls.list_symbol_universe_qualified = cls.symbol_universe_manager.get_symbol_universe()
            len_list = len(cls.list_symbol_universe_qualified)
            msg = 'len(cls.list_symbol_universe_qualified) = {p_len}'.format(p_len=len_list)
            cls.tracer_0.trace(SYMBOL_NONE, 'get_symbol_universe', sErr, msg)
            if len_list == 0:
                cls.list_symbol_universe_qualified = cls.list_symbol_universe_qualified_cfg
        else:
            cls.tracer_0.trace(SYMBOL_NONE, 'get_symbol_universe', sErr, 'create mem db : failed')
            cls.list_symbol_universe_qualified = cls.list_symbol_universe_qualified_cfg
            bErr = False
            sErr = STRING_FAILED
    except Exception as X:
        bErr = False
        sErr = STRING_FAILED
        msg = traceback.format_exc()
        cls.tracer_0.trace(SYMBOL_NONE, 'get_symbol_universe', sErr, msg)
    finally:
        cls.tracer_0.trace(SYMBOL_NONE, 'get_symbol_universe', sErr, LEXEM_FINALLY)
        return bErr</text></g>
<!-- node_d552820d&#45;&gt;node_d552820d -->
<g class="edge" id="edge8">
<title>node_d552820d-&gt;node_d552820d</title>
<path d="M318.35,-288.86C310.83,-288.86 306,-288.86 306,-288.86 306,-288.86 306,-306 306,-306 306,-306 502,-306 502,-306 502,-306 502,-276 502,-276 502,-276 498.72,-276 498.72,-276" fill="none" stroke="#0072b2" stroke-width="2"></path>
<polygon fill="#0072b2" points="498.72,-272.5 488.72,-276 498.72,-279.5 498.72,-272.5" stroke="#0072b2" stroke-width="2"></polygon>
</g>
<!-- node_e2db408c -->
<g class="node" id="node14">
<title>node_e2db408c</title>
<path d="M502,-366C502,-366 305,-366 305,-366 299,-366 293,-360 293,-354 293,-354 293,-342 293,-342 293,-336 299,-330 305,-330 305,-330 502,-330 502,-330 508,-330 514,-336 514,-342 514,-342 514,-354 514,-354 514,-360 508,-366 502,-366" fill="#cccccc" stroke="black"></path>
<text font-family="Times New Roman,serif" font-size="14.00" text-anchor="middle" x="403.5" y="-344.3">706: get_trading_algorithm_params()</text>
<text style="display:none;">@classmethod
def get_trading_algorithm_params(cls):
    bErr = True
    sErr = STRING_SUCCESS
    try:
        cls.dir_path_trading_algorithm_db = DIR_PATH_PARAMS_THIS_APP
        cls.file_name_trading_algorithm_db = cls.file_name_trading_algorithm_db_cfg
        cls.trading_algorithm_manager = CTradingAlgorithm()
        cls.trading_algorithm_manager.set_db_source(cls.dir_path_trading_algorithm_db, cls.file_name_trading_algorithm_db)
        cls.tracer_0.trace(SYMBOL_NONE, 'get_trading_algorithm_params', sErr, 'create trading algorithm manager : success')
        msg = 'file_path_db =   ' + cls.trading_algorithm_manager.file_name_path_db_source
        cls.tracer_0.trace(SYMBOL_NONE, 'get_trading_algorithm_params', sErr, msg)
        if cls.trading_algorithm_manager.create_memory_db():
            cls.tracer_0.trace(SYMBOL_NONE, 'get_trading_algorithm_params', sErr, 'create mem db : success')
            msg = 'is_db_open = {p_is_db_open}'.format(p_is_db_open=cls.trading_algorithm_manager.is_db_open)
            cls.tracer_0.trace(SYMBOL_NONE, 'get_trading_algorithm_params', sErr, msg)
            cls.dict_trading_algorithm_params = cls.trading_algorithm_manager.get_trading_algorithm_params()
            len_dict = len(cls.dict_trading_algorithm_params)
            msg = 'len(cls.dict_trading_algorithm_params) = {p_len}'.format(p_len=len_dict)
            cls.tracer_0.trace(SYMBOL_NONE, 'get_trading_algorithm_params', sErr, msg)
            if len_dict == 0:
                cls.dict_trading_algorithm_params = cls.dict_trading_algorithm_params_cfg
        else:
            cls.tracer_0.trace(SYMBOL_NONE, 'get_trading_algorithm_params', sErr, 'create mem db : failed')
            cls.dict_trading_algorithm_params = cls.dict_trading_algorithm_params_cfg
            bErr = False
            sErr = STRING_FAILED
    except Exception as X:
        bErr = False
        sErr = STRING_FAILED
        msg = traceback.format_exc()
        cls.tracer_0.trace(SYMBOL_NONE, 'get_trading_algorithm_params', sErr, msg)
    finally:
        cls.tracer_0.trace(SYMBOL_NONE, 'get_trading_algorithm_params', sErr, LEXEM_FINALLY)
        return bErr</text></g>
<!-- node_e2db408c&#45;&gt;node_e2db408c -->
<g class="edge" id="edge9">
<title>node_e2db408c-&gt;node_e2db408c</title>
<path d="M292.94,-342C289.18,-342 287,-342 287,-342 287,-342 287,-318 287,-318 287,-318 523,-318 523,-318 523,-318 523,-348 523,-348 523,-348 522.1,-348 522.1,-348" fill="none" stroke="#f0e442" stroke-width="2"></path>
<polygon fill="#f0e442" points="524.02,-344.5 514.02,-348 524.02,-351.5 524.02,-344.5" stroke="#f0e442" stroke-width="2"></polygon>
</g>
<!-- node_b81e3d50 -->
<g class="node" id="node15">
<title>node_b81e3d50</title>
<path d="M520,-438C520,-438 287,-438 287,-438 281,-438 275,-432 275,-426 275,-426 275,-414 275,-414 275,-408 281,-402 287,-402 287,-402 520,-402 520,-402 526,-402 532,-408 532,-414 532,-414 532,-426 532,-426 532,-432 526,-438 520,-438" fill="#cccccc" stroke="black"></path>
<text font-family="Times New Roman,serif" font-size="14.00" text-anchor="middle" x="403.5" y="-416.3">818: get_trading_order_algorithm_params()</text>
<text style="display:none;">@classmethod
def get_trading_order_algorithm_params(cls):
    bErr = True
    sErr = STRING_SUCCESS
    try:
        cls.dir_path_trading_order_algorithm_db = DIR_PATH_PARAMS_THIS_APP
        cls.file_name_trading_order_algorithm_db = cls.file_name_trading_order_algorithm_db_cfg
        cls.trading_order_algorithm_manager = CTradingOrderAlgorithm()
        cls.trading_order_algorithm_manager.set_db_source(cls.dir_path_trading_order_algorithm_db, cls.file_name_trading_order_algorithm_db)
        cls.tracer_0.trace(SYMBOL_NONE, 'get_trading_order_algorithm_params', sErr, 'create trading order algorithm manager : success')
        msg = 'file_path_db =   ' + cls.trading_order_algorithm_manager.file_name_path_db_source
        cls.tracer_0.trace(SYMBOL_NONE, 'get_trading_order_algorithm_params', sErr, msg)
        if cls.trading_order_algorithm_manager.create_memory_db():
            cls.tracer_0.trace(SYMBOL_NONE, 'get_trading_order_algorithm_params', sErr, 'create mem db : success')
            msg = 'is_db_open = {p_is_db_open}'.format(p_is_db_open=cls.trading_order_algorithm_manager.is_db_open)
            cls.tracer_0.trace(SYMBOL_NONE, 'get_trading_order_algorithm_params', sErr, msg)
            cls.dict_trading_order_algorithm_params = cls.trading_order_algorithm_manager.get_trading_order_algorithm_params()
            len_dict = len(cls.dict_trading_order_algorithm_params)
            msg = 'len(cls.dict_trading_order_algorithm_params) = {p_len}'.format(p_len=len_dict)
            cls.tracer_0.trace(SYMBOL_NONE, 'get_trading_order_algorithm_params', sErr, msg)
            if len_dict == 0:
                cls.dict_trading_order_algorithm_params = cls.dict_trading_order_algorithm_params_cfg
        else:
            cls.tracer_0.trace(SYMBOL_NONE, 'get_trading_order_algorithm_params', sErr, 'create mem db : failed')
            cls.dict_trading_order_algorithm_params = cls.dict_trading_order_algorithm_params_cfg
            bErr = False
            sErr = STRING_FAILED
    except Exception as X:
        bErr = False
        sErr = STRING_FAILED
        msg = traceback.format_exc()
        cls.tracer_0.trace(SYMBOL_NONE, 'get_trading_order_algorithm_params', sErr, msg)
    finally:
        cls.tracer_0.trace(SYMBOL_NONE, 'get_trading_order_algorithm_params', sErr, LEXEM_FINALLY)
        return bErr</text></g>
<!-- node_b81e3d50&#45;&gt;node_b81e3d50 -->
<g class="edge" id="edge10">
<title>node_b81e3d50-&gt;node_b81e3d50</title>
<path d="M274.82,-420C272.37,-420 271,-420 271,-420 271,-420 271,-456 271,-456 271,-456 538,-456 538,-456 538,-456 538,-420 538,-420 538,-420 537.42,-420 537.42,-420" fill="none" stroke="#000000" stroke-width="2"></path>
<polygon fill="#000000" points="542.22,-416.5 532.22,-420 542.22,-423.5 542.22,-416.5" stroke="#000000" stroke-width="2"></polygon>
</g>
<!-- node_1a15e40f -->
<g class="node" id="node16">
<title>node_1a15e40f</title>
<path d="M497.5,-510C497.5,-510 309.5,-510 309.5,-510 303.5,-510 297.5,-504 297.5,-498 297.5,-498 297.5,-486 297.5,-486 297.5,-480 303.5,-474 309.5,-474 309.5,-474 497.5,-474 497.5,-474 503.5,-474 509.5,-480 509.5,-486 509.5,-486 509.5,-498 509.5,-498 509.5,-504 503.5,-510 497.5,-510" fill="#6db33f" stroke="black"></path>
<text font-family="Times New Roman,serif" font-size="14.00" text-anchor="middle" x="403.5" y="-488.3">338: initialize_default_parameters()</text>
<text style="display:none;">@classmethod
def initialize_default_parameters(cls):
    cls.list_symbol_universe_qualified_cfg = aktpdtrprm.LIST_SYMBOL_UNIVERSE_QUALIFIED
    cls.file_name_symbol_universe_db_cfg = aktpdtrprm.FILE_NAME_SYMBOL_UNIVERSE_DB
    cls.dict_trading_algorithm_params_cfg = {}
    cls.file_name_trading_algorithm_db_cfg = aktpdtrprm.FILE_NAME_TRADING_ALGORITHM_DB
    cls.dict_risk_management_algorithm_params_cfg = {}
    cls.file_name_risk_management_algorithm_db_cfg = aktpdtrprm.FILE_NAME_RISK_MANAGEMENT_ALGORITHM_DB
    cls.dict_trading_order_algorithm_params_cfg = {}
    cls.file_name_trading_order_algorithm_db_cfg = aktpdtrprm.FILE_NAME_TRADING_ORDER_ALGORITHM_DB
    cls.enable_trade_entry_market_open_before_cfg = aktpdtrprm.ENABLE_TRADE_ENTRY_MARKET_OPEN_BEFORE
    cls.duration_trade_entry_market_open_before_cfg = aktpdtrprm.DURATION_TRADE_ENTRY_MARKET_OPEN_BEFORE
    cls.duration_trade_max_market_open_before_cfg = aktpdtrprm.DURATION_TRADE_MAX_MARKET_OPEN_BEFORE
    cls.enable_trade_entry_market_open_after_cfg = aktpdtrprm.ENABLE_TRADE_ENTRY_MARKET_OPEN_AFTER
    cls.duration_trade_entry_market_open_after_cfg = aktpdtrprm.DURATION_TRADE_ENTRY_MARKET_OPEN_AFTER
    cls.duration_trade_max_market_open_after_cfg = aktpdtrprm.DURATION_TRADE_MAX_MARKET_OPEN_AFTER
    cls.enable_trade_entry_intra_day_cfg = aktpdtrprm.ENABLE_TRADE_ENTRY_INTRA_DAY
    cls.time_trade_entry_intra_day_cfg = aktpdtrprm.TIME_TRADE_ENTRY_INTRA_DAY
    cls.duration_trade_entry_intra_day_cfg = aktpdtrprm.DURATION_TRADE_ENTRY_INTRA_DAY
    cls.duration_trade_max_intra_day_cfg = aktpdtrprm.DURATION_TRADE_MAX_INTRA_DAY
    cls.enable_trade_entry_market_close_before_cfg = aktpdtrprm.ENABLE_TRADE_ENTRY_MARKET_CLOSE_BEFORE
    cls.duration_trade_entry_market_close_before_cfg = aktpdtrprm.DURATION_TRADE_ENTRY_MARKET_CLOSE_BEFORE
    cls.duration_trade_max_market_close_before_cfg = aktpdtrprm.DURATION_TRADE_MAX_MARKET_CLOSE_BEFORE
    cls.enable_trade_entry_market_close_after_cfg = aktpdtrprm.ENABLE_TRADE_ENTRY_MARKET_CLOSE_AFTER
    cls.duration_trade_entry_market_close_after_cfg = aktpdtrprm.DURATION_TRADE_ENTRY_MARKET_CLOSE_AFTER
    cls.duration_trade_max_market_close_after_cfg = aktpdtrprm.DURATION_TRADE_MAX_MARKET_CLOSE_AFTER
    cls.bid_price_buy_init_delta_coeff_cfg = aktpdtrprm.BID_PRICE_BUY_INIT_DELTA_COEFF
    cls.ask_price_sell_init_delta_coeff_cfg = aktpdtrprm.ASK_PRICE_SELL_INIT_DELTA_COEFF
    cls.bid_price_buy_increase_delta_coeff_cfg = aktpdtrprm.BID_PRICE_BUY_INCREASE_DELTA_COEFF
    cls.ask_price_sell_increase_delta_coeff_cfg = aktpdtrprm.ASK_PRICE_SELL_INCREASE_DELTA_COEFF
    cls.bid_price_buy_exit_delta_coeff_cfg = aktpdtrprm.BID_PRICE_BUY_EXIT_DELTA_COEFF
    cls.ask_price_sell_exit_delta_coeff_cfg = aktpdtrprm.ASK_PRICE_SELL_EXIT_DELTA_COEFF
    cls.stop_price_init_interval_coeff_down_buy_cfg = aktpdtrprm.STOP_PRICE_INIT_INTERVAL_COEFF_DOWN_BUY
    cls.stop_price_init_interval_coeff_up_sell_cfg = aktpdtrprm.STOP_PRICE_INIT_INTERVAL_COEFF_UP_SELL
    cls.stop_price_trail_interval_coeff_down_buy_cfg = aktpdtrprm.STOP_PRICE_TRAIL_INTERVAL_COEFF_DOWN_BUY
    cls.stop_price_trail_interval_coeff_up_sell_cfg = aktpdtrprm.STOP_PRICE_TRAIL_INTERVAL_COEFF_UP_SELL
    cls.stop_price_trail_threshold_interval_coeff_down_buy_cfg = aktpdtrprm.STOP_PRICE_TRAIL_THRESHOLD_INTERVAL_COEFF_DOWN_BUY
    cls.stop_price_trail_threshold_interval_coeff_up_sell_cfg = aktpdtrprm.STOP_PRICE_TRAIL_THRESHOLD_INTERVAL_COEFF_UP_SELL
    cls.stop_price_trail_step_interval_coeff_down_buy_cfg = aktpdtrprm.STOP_PRICE_TRAIL_STEP_INTERVAL_COEFF_DOWN_BUY
    cls.stop_price_trail_step_interval_coeff_up_sell_cfg = aktpdtrprm.STOP_PRICE_TRAIL_STEP_INTERVAL_COEFF_UP_SELL
    cls.stop_price_trail_step_count_max_down_buy_cfg = aktpdtrprm.STOP_PRICE_TRAIL_STEP_COUNT_MAX_DOWN_BUY
    cls.stop_price_trail_step_count_max_up_sell_cfg = aktpdtrprm.STOP_PRICE_TRAIL_STEP_COUNT_MAX_UP_SELL
    cls.stop_price_trail_base_type_cfg = aktpdtrprm.STOP_PRICE_TRAIL_BASE_TYPE
    cls.stop_price_trail_type_cfg = aktpdtrprm.STOP_PRICE_TRAIL_TYPE
    cls.reward_risk_ratio_price_target_buy_cfg = aktpdtrprm.REWARD_RISK_RATIO_PRICE_TARGET_BUY
    cls.reward_risk_ratio_price_target_sell_cfg = aktpdtrprm.REWARD_RISK_RATIO_PRICE_TARGET_SELL
    cls.buying_power_total_cfg = aktpdtrprm.BUYING_POWER_TOTAL
    cls.buying_power_per_order_cfg = aktpdtrprm.BUYING_POWER_PER_ORDER
    cls.buying_power_per_position_cfg = aktpdtrprm.BUYING_POWER_PER_POSITION
    cls.shares_per_position_max_cfg = aktpdtrprm.SHARES_PER_POSITION_MAX
    cls.shares_per_order_max_cfg = aktpdtrprm.SHARES_PER_ORDER_MAX
    cls.max_orders_per_second_cfg = aktpdtrprm.MAX_ORDERS_PER_SECOND
    cls.max_orders_per_second_in_symbol_cfg = aktpdtrprm.MAX_ORDERS_PER_SECOND_IN_SYMBOL
    cls.max_orders_per_second_without_ack_cfg = aktpdtrprm.MAX_ORDERS_PER_SECOND_WITHOUT_ACK
    cls.buying_power_per_order_init_coeff_cfg = aktpdtrprm.BUYING_POWER_PER_ORDER_INIT_COEFF
    cls.buying_power_per_position_init_coeff_cfg = aktpdtrprm.BUYING_POWER_PER_POSITION_INIT_COEFF
    cls.shares_per_order_max_init_coeff_cfg = aktpdtrprm.SHARES_PER_ORDER_MAX_INIT_COEFF
    cls.shares_per_position_max_init_coeff_cfg = aktpdtrprm.SHARES_PER_POSITION_MAX_INIT_COEFF
    cls.trade_order_algo_type_buy_init_cfg = aktpdtrprm.TRADE_ORDER_ALGO_TYPE_BUY_INIT
    cls.trade_order_algo_type_sell_init_cfg = aktpdtrprm.TRADE_ORDER_ALGO_TYPE_SELL_INIT
    cls.trade_order_algo_type_buy_increase_cfg = aktpdtrprm.TRADE_ORDER_ALGO_TYPE_BUY_INCREASE
    cls.trade_order_algo_type_sell_increase_cfg = aktpdtrprm.TRADE_ORDER_ALGO_TYPE_SELL_INCREASE
    cls.trade_order_algo_type_buy_decrease_cfg = aktpdtrprm.TRADE_ORDER_ALGO_TYPE_BUY_INCREASE
    cls.trade_order_algo_type_sell_decrease_cfg = aktpdtrprm.TRADE_ORDER_ALGO_TYPE_SELL_INCREASE
    cls.trade_order_algo_type_buy_exit_cfg = aktpdtrprm.TRADE_ORDER_ALGO_TYPE_BUY_EXIT
    cls.trade_order_algo_type_sell_exit_cfg = aktpdtrprm.TRADE_ORDER_ALGO_TYPE_SELL_EXIT
    cls.duration_exit_trade_all_market_close_before_cfg = aktpdtrprm.DURATION_EXIT_TRADE_ALL_MARKET_CLOSE_BEFORE
    cls.enable_alerter_0_cfg = aktpdtrprm_plf.ENABLE_ALERTER_0
    cls.enable_alerter_1_cfg = aktpdtrprm_plf.ENABLE_ALERTER_1
    cls.enable_alerter_2_cfg = aktpdtrprm_plf.ENABLE_ALERTER_2
    cls.enable_alerter_3_cfg = aktpdtrprm_plf.ENABLE_ALERTER_3
    cls.enable_alerter_this_script_cfg = aktpdtrprm_plf.ENABLE_ALERTER_THIS_SCRIPT
    cls.enable_debug_using_ktg_alert = aktpdtrprm_plf.DEBUG_USING_KTG_ALERT
    cls.alert_guid_debug_ktg_alert = None
    cls.list_message_field_id_debug_ktg_alert = []
    cls.enable_log_symbol_universe_all_cfg = aktpdtrprm.ENABLE_LOG_SYMBOL_UNIVERSE_ALL
    cls.enable_log_trade_algo_params_per_symbol_cfg = aktpdtrprm.ENABLE_LOG_TRADE_ALGO_PARAMS_PER_SYMBOL
    cls.enable_log_risk_management_algo_params_per_symbol_cfg = aktpdtrprm.ENABLE_LOG_RISK_MANAGEMENT_ALGO_PARAMS_PER_SYMBOL
    cls.enable_log_trade_order_algo_params_per_symbol_cfg = aktpdtrprm.ENABLE_LOG_TRADE_ORDER_ALGO_PARAMS_PER_SYMBOL
    cls.enable_log_trade_on_fill_params_per_symbol_cfg = aktpdtrprm.ENABLE_LOG_TRADE_ON_FILL_PARAMS_PER_SYMBOL
    cls.enable_log_trade_exit_params_per_symbol_cfg = aktpdtrprm.ENABLE_LOG_TRADE_EXIT_PARAMS_PER_SYMBOL</text></g>
<!-- node_d0b12c38 -->
<g class="node" id="node17">
<title>node_d0b12c38</title>
<path d="M872.5,-766C872.5,-766 723.5,-766 723.5,-766 717.5,-766 711.5,-760 711.5,-754 711.5,-754 711.5,-742 711.5,-742 711.5,-736 717.5,-730 723.5,-730 723.5,-730 872.5,-730 872.5,-730 878.5,-730 884.5,-736 884.5,-742 884.5,-742 884.5,-754 884.5,-754 884.5,-760 878.5,-766 872.5,-766" fill="#6db33f" stroke="black"></path>
<text font-family="Times New Roman,serif" font-size="14.00" text-anchor="middle" x="798" y="-744.3">2234: initialize_order_long()</text>
<text style="display:none;">def initialize_order_long(self):
    self.order_id_buy_init = ''
    self.order_id_buy_increase = ''
    self.order_id_buy_decrease = ''
    self.price_on_fill_buy_init = 0.0
    self.price_on_fill_buy_increase = 0.0
    self.stop_price_down_buy = 0.0
    self.price_high_day_since_on_fill = 0.0
    self.price_stop_trail_base = 0.0
    self.stop_price_trail_threshold_buy = 0.0
    self.stop_price_trail_step_buy_count = 0
    self.is_order_buy_init_placed = False
    self.is_order_buy_init_acknowleged = False
    self.is_order_buy_init_filled = False
    self.is_order_buy_increase_placed = False
    self.is_order_buy_increase_acknowleged = False
    self.is_order_buy_increase_filled = False
    self.is_order_buy_decrease_placed = False
    self.is_order_buy_decrease_acknowleged = False
    self.is_order_buy_decrease_filled = False
    self.is_stop_price_down_buy_set = False
    self.is_stop_price_trail_threshold_buy_set = False
    self.time_stop_trade_buy_on_fill_reference = 0
    self.price_target_buy = 0.0</text></g>
<!-- node_7b0a0283 -->
<g class="node" id="node18">
<title>node_7b0a0283</title>
<path d="M874,-601C874,-601 722,-601 722,-601 716,-601 710,-595 710,-589 710,-589 710,-577 710,-577 710,-571 716,-565 722,-565 722,-565 874,-565 874,-565 880,-565 886,-571 886,-577 886,-577 886,-589 886,-589 886,-595 880,-601 874,-601" fill="#6db33f" stroke="black"></path>
<text font-family="Times New Roman,serif" font-size="14.00" text-anchor="middle" x="798" y="-579.3">2270: initialize_order_short()</text>
<text style="display:none;">def initialize_order_short(self):
    self.order_id_sell_init = ''
    self.order_id_sell_increase = ''
    self.order_id_sell_decrease = ''
    self.price_on_fill_sell_init = 0.0
    self.price_on_fill_sell_increase = 0.0
    self.stop_price_up_sell = 0.0
    self.price_high_day_since_on_fill = 0.0
    self.price_stop_trail_base = 0.0
    self.stop_price_trail_threshold_sell = 0.0
    self.stop_price_trail_step_sell_count = 0
    self.is_order_sell_init_placed = False
    self.is_order_sell_init_acknowleged = False
    self.is_order_sell_init_filled = False
    self.is_order_sell_increase_placed = False
    self.is_order_sell_increase_acknowleged = False
    self.is_order_sell_increase_filled = False
    self.is_order_sell_decrease_placed = False
    self.is_order_sell_decrease_acknowleged = False
    self.is_order_sell_decrease_filled = False
    self.is_stop_price_up_sell_set = False
    self.is_stop_price_trail_threshold_sell_set = False
    self.time_stop_trade_sell_on_fill_reference = 0
    self.price_target_sell = 0.0</text></g>
<!-- node_2e67684e -->
<g class="node" id="node19">
<title>node_2e67684e</title>
<path d="M980,-874C980,-874 616,-874 616,-874 610,-874 604,-868 604,-862 604,-862 604,-850 604,-850 604,-844 610,-838 616,-838 616,-838 980,-838 980,-838 986,-838 992,-844 992,-850 992,-850 992,-862 992,-862 992,-868 986,-874 980,-874" fill="#6db33f" stroke="black"></path>
<text font-family="Times New Roman,serif" font-size="14.00" text-anchor="middle" x="798" y="-852.3">1215: initialize_risk_management_algorithm_params_for_symbol()</text>
<text style="display:none;">def initialize_risk_management_algorithm_params_for_symbol(self, md, order, service, account):
    bErr = True
    sErr = STRING_SUCCESS
    try:
        if md.symbol in type(self).dict_risk_management_algorithm_params:
            rm_algo_params = type(self).dict_risk_management_algorithm_params[md.symbol]
            self.buying_power_per_order_init_coeff = rm_algo_params[LEXEM_BUYING_POWER_PER_ORDER_INIT_COEFF]
            self.buying_power_per_position_init_coeff = rm_algo_params[LEXEM_BUYING_POWER_PER_POSITION_INIT_COEFF]
            self.shares_per_order_max_init_coeff = rm_algo_params[LEXEM_SHARES_PER_ORDER_MAX_INIT_COEFF]
            self.shares_per_position_max_init_coeff = rm_algo_params[LEXEM_SHARES_PER_POSITION_MAX_INIT_COEFF]
        else:
            self.buying_power_per_order_init_coeff = type(self).buying_power_per_order_init_coeff_cfg
            self.buying_power_per_position_init_coeff = type(self).buying_power_per_position_init_coeff_cfg
            self.shares_per_order_max_init_coeff = type(self).shares_per_order_max_init_coeff_cfg
            self.shares_per_position_max_init_coeff = type(self).shares_per_position_max_init_coeff_cfg
    except Exception as X:
        bErr = False
        sErr = STRING_FAILED
        msg = traceback.format_exc()
        type(self).tracer_0.trace(md.symbol, 'initialize_risk_management_algorithm_params_for_symbol', sErr, msg)
    finally:
        type(self).tracer_0.trace(md.symbol, 'initialize_risk_management_algorithm_params_for_symbol', sErr, LEXEM_FINALLY)
        return bErr</text></g>
<!-- node_ca9d1adf -->
<g class="node" id="node20">
<title>node_ca9d1adf</title>
<path d="M950.5,-928C950.5,-928 645.5,-928 645.5,-928 639.5,-928 633.5,-922 633.5,-916 633.5,-916 633.5,-904 633.5,-904 633.5,-898 639.5,-892 645.5,-892 645.5,-892 950.5,-892 950.5,-892 956.5,-892 962.5,-898 962.5,-904 962.5,-904 962.5,-916 962.5,-916 962.5,-922 956.5,-928 950.5,-928" fill="#6db33f" stroke="black"></path>
<text font-family="Times New Roman,serif" font-size="14.00" text-anchor="middle" x="798" y="-906.3">1092: initialize_trading_algorithm_params_for_symbol()</text>
<text style="display:none;">def initialize_trading_algorithm_params_for_symbol(self, md, order, service, account):
    bErr = True
    sErr = STRING_SUCCESS
    try:
        if md.symbol in type(self).dict_trading_algorithm_params:
            trading_algo_params = type(self).dict_trading_algorithm_params[md.symbol]
            self.enable_trade_entry_market_open_before = trading_algo_params[LEXEM_ENABLE_TRADE_ENTRY_MARKET_OPEN_BEFORE]
            self.duration_trade_entry_market_open_before = trading_algo_params[LEXEM_DURATION_TRADE_ENTRY_MARKET_OPEN_BEFORE]
            self.duration_trade_max_market_open_before = trading_algo_params[LEXEM_DURATION_TRADE_MAX_MARKET_OPEN_BEFORE]
            self.enable_trade_entry_market_open_after = trading_algo_params[LEXEM_ENABLE_TRADE_ENTRY_MARKET_OPEN_AFTER]
            self.duration_trade_entry_market_open_after = trading_algo_params[LEXEM_DURATION_TRADE_ENTRY_MARKET_OPEN_AFTER]
            self.duration_trade_max_market_open_after = trading_algo_params[LEXEM_DURATION_TRADE_MAX_MARKET_OPEN_AFTER]
            self.enable_trade_entry_intra_day = trading_algo_params[LEXEM_ENABLE_TRADE_ENTRY_INTRA_DAY]
            self.time_trade_entry_intra_day = trading_algo_params[LEXEM_TIME_TRADE_ENTRY_INTRA_DAY]
            self.duration_trade_entry_intra_day = trading_algo_params[LEXEM_DURATION_TRADE_ENTRY_INTRA_DAY]
            self.duration_trade_max_intra_day = trading_algo_params[LEXEM_DURATION_TRADE_MAX_INTRA_DAY]
            self.enable_trade_entry_market_close_before = trading_algo_params[LEXEM_ENABLE_TRADE_ENTRY_MARKET_CLOSE_BEFORE]
            self.duration_trade_entry_market_close_before = trading_algo_params[LEXEM_DURATION_TRADE_ENTRY_MARKET_CLOSE_BEFORE]
            self.duration_trade_max_market_close_before = trading_algo_params[LEXEM_DURATION_TRADE_MAX_MARKET_CLOSE_BEFORE]
            self.enable_trade_entry_market_close_after = trading_algo_params[LEXEM_ENABLE_TRADE_ENTRY_MARKET_CLOSE_AFTER]
            self.duration_trade_entry_market_close_after = trading_algo_params[LEXEM_DURATION_TRADE_ENTRY_MARKET_CLOSE_AFTER]
            self.duration_trade_max_market_close_after = trading_algo_params[LEXEM_DURATION_TRADE_MAX_MARKET_CLOSE_AFTER]
            self.bid_price_buy_init_delta_coeff = trading_algo_params[LEXEM_BID_PRICE_BUY_INIT_DELTA_COEFF]
            self.ask_price_sell_init_delta_coeff = trading_algo_params[LEXEM_ASK_PRICE_SELL_INIT_DELTA_COEFF]
            self.bid_price_buy_increase_delta_coeff = trading_algo_params[LEXEM_BID_PRICE_BUY_INCREASE_DELTA_COEFF]
            self.ask_price_sell_increase_delta_coeff = trading_algo_params[LEXEM_ASK_PRICE_SELL_INCREASE_DELTA_COEFF]
            self.bid_price_buy_exit_delta_coeff = trading_algo_params[LEXEM_BID_PRICE_BUY_EXIT_DELTA_COEFF]
            self.ask_price_sell_exit_delta_coeff = trading_algo_params[LEXEM_ASK_PRICE_SELL_EXIT_DELTA_COEFF]
            self.stop_price_init_interval_coeff_down_buy = trading_algo_params[LEXEM_STOP_PRICE_INIT_INTERVAL_COEFF_DOWN_BUY]
            self.stop_price_init_interval_coeff_up_sell = trading_algo_params[LEXEM_STOP_PRICE_INIT_INTERVAL_COEFF_UP_SELL]
            self.stop_price_trail_interval_coeff_down_buy = trading_algo_params[LEXEM_STOP_PRICE_TRAIL_INTERVAL_COEFF_DOWN_BUY]
            self.stop_price_trail_interval_coeff_up_sell = trading_algo_params[LEXEM_STOP_PRICE_TRAIL_INTERVAL_COEFF_UP_SELL]
            self.stop_price_trail_threshold_interval_coeff_down_buy = trading_algo_params[LEXEM_STOP_PRICE_TRAIL_THRESHOLD_INTERVAL_COEFF_DOWN_BUY]
            self.stop_price_trail_threshold_interval_coeff_up_sell = trading_algo_params[LEXEM_STOP_PRICE_TRAIL_THRESHOLD_INTERVAL_COEFF_UP_SELL]
            self.stop_price_trail_step_interval_coeff_down_buy = trading_algo_params[LEXEM_STOP_PRICE_TRAIL_STEP_INTERVAL_COEFF_DOWN_BUY]
            self.stop_price_trail_step_interval_coeff_up_sell = trading_algo_params[LEXEM_STOP_PRICE_TRAIL_STEP_INTERVAL_COEFF_UP_SELL]
            self.stop_price_trail_step_count_max_down_buy = trading_algo_params[LEXEM_STOP_PRICE_TRAIL_STEP_COUNT_MAX_DOWN_BUY]
            self.stop_price_trail_step_count_max_up_sell = trading_algo_params[LEXEM_STOP_PRICE_TRAIL_STEP_COUNT_MAX_UP_SELL]
            self.stop_price_trail_base_type = trading_algo_params[LEXEM_STOP_PRICE_TRAIL_BASE_TYPE]
            self.stop_price_trail_type = trading_algo_params[LEXEM_STOP_PRICE_TRAIL_TYPE]
            self.reward_risk_ratio_price_target_buy = trading_algo_params[LEXEM_REWARD_RISK_RATIO_PRICE_TARGET_BUY]
            self.reward_risk_ratio_price_target_sell = trading_algo_params[LEXEM_REWARD_RISK_RATIO_PRICE_TARGET_SELL]
        else:
            self.enable_trade_entry_market_open_before = type(self).enable_trade_entry_market_open_before_cfg
            self.duration_trade_entry_market_open_before = type(self).duration_trade_entry_market_open_before_cfg
            self.duration_trade_max_market_open_before = type(self).duration_trade_max_market_open_before_cfg
            self.enable_trade_entry_market_open_after = type(self).enable_trade_entry_market_open_after_cfg
            self.duration_trade_entry_market_open_after = type(self).duration_trade_entry_market_open_after_cfg
            self.duration_trade_max_market_open_after = type(self).duration_trade_max_market_open_after_cfg
            self.enable_trade_entry_intra_day = type(self).enable_trade_entry_intra_day_cfg
            self.time_trade_entry_intra_day = type(self).time_trade_entry_intra_day_cfg
            self.duration_trade_entry_intra_day = type(self).duration_trade_entry_intra_day_cfg
            self.duration_trade_max_intra_day = type(self).duration_trade_max_intra_day_cfg
            self.enable_trade_entry_market_close_before = type(self).enable_trade_entry_market_close_before_cfg
            self.duration_trade_entry_market_close_before = type(self).duration_trade_entry_market_close_before_cfg
            self.duration_trade_max_market_close_before = type(self).duration_trade_max_market_close_before_cfg
            self.enable_trade_entry_market_close_after = type(self).enable_trade_entry_market_close_after_cfg
            self.duration_trade_entry_market_close_after = type(self).duration_trade_entry_market_close_after_cfg
            self.duration_trade_max_market_close_after = type(self).duration_trade_max_market_close_after_cfg
            self.bid_price_buy_init_delta_coeff = type(self).bid_price_buy_init_delta_coeff_cfg
            self.ask_price_sell_init_delta_coeff = type(self).ask_price_sell_init_delta_coeff_cfg
            self.bid_price_buy_increase_delta_coeff = type(self).bid_price_buy_increase_delta_coeff_cfg
            self.ask_price_sell_increase_delta_coeff = type(self).ask_price_sell_increase_delta_coeff_cfg
            self.bid_price_buy_exit_delta_coeff = type(self).bid_price_buy_exit_delta_coeff_cfg
            self.ask_price_sell_exit_delta_coeff = type(self).ask_price_sell_exit_delta_coeff_cfg
            self.stop_price_init_interval_coeff_down_buy = type(self).stop_price_init_interval_coeff_down_buy_cfg
            self.stop_price_init_interval_coeff_up_sell = type(self).stop_price_init_interval_coeff_up_sell_cfg
            self.stop_price_trail_interval_coeff_down_buy = type(self).stop_price_trail_interval_coeff_down_buy_cfg
            self.stop_price_trail_interval_coeff_up_sell = type(self).stop_price_trail_interval_coeff_up_sell_cfg
            self.stop_price_trail_threshold_interval_coeff_down_buy = type(self).stop_price_trail_threshold_interval_coeff_down_buy_cfg
            self.stop_price_trail_threshold_interval_coeff_up_sell = type(self).stop_price_trail_threshold_interval_coeff_up_sell_cfg
            self.stop_price_trail_step_interval_coeff_down_buy = type(self).stop_price_trail_step_interval_coeff_down_buy_cfg
            self.stop_price_trail_step_interval_coeff_up_sell = type(self).stop_price_trail_step_interval_coeff_up_sell_cfg
            self.stop_price_trail_step_count_max_down_buy = type(self).stop_price_trail_step_count_max_down_buy_cfg
            self.stop_price_trail_step_count_max_up_sell = type(self).stop_price_trail_step_count_max_up_sell_cfg
            self.stop_price_trail_base_type = type(self).stop_price_trail_base_type_cfg
            self.stop_price_trail_type = type(self).stop_price_trail_type_cfg
            self.reward_risk_ratio_price_target_buy = type(self).reward_risk_ratio_price_target_buy_cfg
            self.reward_risk_ratio_price_target_sell = type(self).reward_risk_ratio_price_target_sell_cfg
        self.risk_price_down_buy_interval_coeff = self.stop_price_init_interval_coeff_down_buy
        self.risk_price_up_sell_interval_coeff = self.stop_price_init_interval_coeff_up_sell
    except Exception as X:
        bErr = False
        sErr = STRING_FAILED
        msg = traceback.format_exc()
        type(self).tracer_0.trace(md.symbol, 'initialize_trading_algorithm_params_for_symbol', sErr, msg)
    finally:
        type(self).tracer_0.trace(md.symbol, 'initialize_trading_algorithm_params_for_symbol', sErr, LEXEM_FINALLY)
        return bErr</text></g>
<!-- node_0de43f5d -->
<g class="node" id="node21">
<title>node_0de43f5d</title>
<path d="M968,-820C968,-820 628,-820 628,-820 622,-820 616,-814 616,-808 616,-808 616,-796 616,-796 616,-790 622,-784 628,-784 628,-784 968,-784 968,-784 974,-784 980,-790 980,-796 980,-796 980,-808 980,-808 980,-814 974,-820 968,-820" fill="#6db33f" stroke="black"></path>
<text font-family="Times New Roman,serif" font-size="14.00" text-anchor="middle" x="798" y="-798.3">1243: initialize_trading_order_algorithm_params_for_symbol()</text>
<text style="display:none;">def initialize_trading_order_algorithm_params_for_symbol(self, md, order, service, account):
    bErr = True
    sErr = STRING_SUCCESS
    try:
        if md.symbol in type(self).dict_trading_order_algorithm_params:
            to_algo_params = type(self).dict_trading_order_algorithm_params[md.symbol]
            self.trade_order_algo_type_buy_init = to_algo_params[LEXEM_ORDER_ALGO_TYPE_BUY_INIT]
            self.trade_order_algo_type_sell_init = to_algo_params[LEXEM_ORDER_ALGO_TYPE_SELL_INIT]
            self.trade_order_algo_type_buy_increase = to_algo_params[LEXEM_ORDER_ALGO_TYPE_BUY_INCREASE]
            self.trade_order_algo_type_sell_increase = to_algo_params[LEXEM_ORDER_ALGO_TYPE_SELL_INCREASE]
            self.trade_order_algo_type_buy_decrease = to_algo_params[LEXEM_ORDER_ALGO_TYPE_BUY_DECREASE]
            self.trade_order_algo_type_sell_decrease = to_algo_params[LEXEM_ORDER_ALGO_TYPE_SELL_DECREASE]
            self.trade_order_algo_type_buy_exit = to_algo_params[LEXEM_ORDER_ALGO_TYPE_BUY_EXIT]
            self.trade_order_algo_type_sell_exit = to_algo_params[LEXEM_ORDER_ALGO_TYPE_SELL_EXIT]
        else:
            self.trade_order_algo_type_buy_init = type(self).trade_order_algo_type_buy_init_cfg
            self.trade_order_algo_type_sell_init = type(self).trade_order_algo_type_sell_init_cfg
            self.trade_order_algo_type_buy_increase = type(self).trade_order_algo_type_buy_increase_cfg
            self.trade_order_algo_type_sell_increase = type(self).trade_order_algo_type_sell_increase_cfg
            self.trade_order_algo_type_buy_decrease = type(self).trade_order_algo_type_buy_decrease_cfg
            self.trade_order_algo_type_sell_decrease = type(self).trade_order_algo_type_sell_decrease_cfg
            self.trade_order_algo_type_buy_exit = type(self).trade_order_algo_type_buy_exit_cfg
            self.trade_order_algo_type_sell_exit = type(self).trade_order_algo_type_sell_exit_cfg
    except Exception as X:
        bErr = False
        sErr = STRING_FAILED
        msg = traceback.format_exc()
        type(self).tracer_0.trace(md.symbol, 'initialize_trading_order_algorithm_params_for_symbol', sErr, msg)
    finally:
        type(self).tracer_0.trace(md.symbol, 'initialize_trading_order_algorithm_params_for_symbol', sErr, LEXEM_FINALLY)
        return bErr</text></g>
<!-- node_bc890cbb -->
<g class="node" id="node22">
<title>node_bc890cbb</title>
<path d="M556,-564C556,-564 251,-564 251,-564 245,-564 239,-558 239,-552 239,-552 239,-540 239,-540 239,-534 245,-528 251,-528 251,-528 556,-528 556,-528 562,-528 568,-534 568,-540 568,-540 568,-552 568,-552 568,-558 562,-564 556,-564" fill="#6db33f" stroke="black"></path>
<text font-family="Times New Roman,serif" font-size="14.00" text-anchor="middle" x="403.5" y="-542.3">1480: log_risk_management_algo_params_per_symbol()</text>
<text style="display:none;">def log_risk_management_algo_params_per_symbol(self):
    bErr = True
    sErr = STRING_SUCCESS
    try:
        msg = '\n\nbuying_power_per_order_init_coeff      = {p_buying_power_per_order_init_coeff} \nbuying_power_per_position_init_coeff   = {p_buying_power_per_position_init_coeff} \nshares_per_order_max_init_coeff        = {p_shares_per_order_max_init_coeff} \nshares_per_position_max_init_coeff     = {p_shares_per_position_max_init_coeff} \n'.format(p_buying_power_per_order_init_coeff=self.buying_power_per_order_init_coeff, p_buying_power_per_position_init_coeff=self.buying_power_per_position_init_coeff, p_shares_per_order_max_init_coeff=self.shares_per_order_max_init_coeff, p_shares_per_position_max_init_coeff=self.shares_per_position_max_init_coeff)
        type(self).tracer_0.trace(self.symbol, 'log_risk_management_algo_params_per_symbol', 'parameters of risk management algorithm', msg)
    except Exception as X:
        bErr = False
        sErr = STRING_FAILED
        msg = traceback.format_exc()
        type(self).tracer_0.trace(self.symbol, 'log_risk_management_algo_params_per_symbol', sErr, msg)
    finally:
        type(self).tracer_0.trace(self.symbol, 'log_risk_management_algo_params_per_symbol', sErr, LEXEM_FINALLY)
        return bErr</text></g>
<!-- node_4c9031b0 -->
<g class="node" id="node23">
<title>node_4c9031b0</title>
<path d="M521,-692C521,-692 286,-692 286,-692 280,-692 274,-686 274,-680 274,-680 274,-668 274,-668 274,-662 280,-656 286,-656 286,-656 521,-656 521,-656 527,-656 533,-662 533,-668 533,-668 533,-680 533,-680 533,-686 527,-692 521,-692" fill="#6db33f" stroke="black"></path>
<text font-family="Times New Roman,serif" font-size="14.00" text-anchor="middle" x="403.5" y="-670.3">1353: log_trade_algo_params_per_symbol()</text>
<text style="display:none;">def log_trade_algo_params_per_symbol(self):
    bErr = True
    sErr = STRING_SUCCESS
    try:
        msg = '\n\nenable_trade_entry_bmo = {p_enable_trade_entry_bmo} \nduration_trade_entry_bmo = {p_duration_trade_entry_bmo} \nduration_trade_max_bmo = {p_duration_trade_max_bmo} \nenable_trade_entry_amo = {p_enable_trade_entry_amo} \nduration_trade_entry_amo = {p_duration_trade_entry_amo} \nduration_trade_max_amo = {p_duration_trade_max_amo} \nenable_trade_entry_intra_day = {p_enable_trade_entry_intra_day} \ntime_trade_entry_intra_day = {p_time_trade_entry_intra_day} \nduration_trade_entry_intra_day = {p_duration_trade_entry_intra_day} \nduration_trade_max_intra_day = {p_duration_trade_max_intra_day} \nenable_trade_entry_bmc = {p_enable_trade_entry_bmc} \nduration_trade_entry_bmc = {p_duration_trade_entry_bmc} \nduration_trade_max_bmc = {p_duration_trade_max_bmc} \nenable_trade_entry_amc = {p_enable_trade_entry_amc} \nduration_trade_entry_amc = {p_duration_trade_entry_amc} \nduration_trade_max_amc = {p_duration_trade_max_amc} \nbid_price_buy_init_delta_coeff     = {p_bid_price_buy_init_delta_coeff} \nask_price_sell_init_delta_coeff    = {p_ask_price_sell_init_delta_coeff} \nbid_price_buy_increase_delta_coeff  = {p_bid_price_buy_increase_delta_coeff} \nask_price_sell_increase_delta_coeff = {p_ask_price_sell_increase_delta_coeff} \nbid_price_buy_exit_delta_coeff      = {p_bid_price_buy_exit_delta_coeff} \nask_price_sell_exit_delta_coeff     = {p_ask_price_sell_exit_delta_coeff} \nstop_price_init_interval_coeff_down_buy = {p_stop_price_init_interval_coeff_down_buy} \nstop_price_init_interval_coeff_up_sell = {p_stop_price_init_interval_coeff_up_sell} \nstop_price_trail_interval_coeff_down_buy = {p_stop_price_trail_interval_coeff_down_buy} \nstop_price_trail_interval_coeff_up_sell = {p_stop_price_trail_interval_coeff_up_sell} \nstop_price_trail_threshold_interval_coeff_down_buy = {p_stop_price_trail_threshold_interval_coeff_down_buy} \nstop_price_trail_threshold_interval_coeff_up_sell = {p_stop_price_trail_threshold_interval_coeff_up_sell} \nstop_price_trail_step_interval_coeff_down_buy = {p_stop_price_trail_step_interval_coeff_down_buy} \nstop_price_trail_step_interval_coeff_up_sell = {p_stop_price_trail_step_interval_coeff_up_sell} \nstop_price_trail_step_count_max_down_buy = {p_stop_price_trail_step_count_max_down_buy} \nstop_price_trail_step_count_max_up_sell = {p_stop_price_trail_step_count_max_up_sell} \nstop_price_trail_base_type = {p_stop_price_trail_base_type} \nstop_price_trail_type = {p_stop_price_trail_type} \nreward_risk_ratio_price_target_buy = {p_reward_risk_ratio_price_target_buy} \nreward_risk_ratio_price_target_sell = {p_reward_risk_ratio_price_target_sell} \nrisk_price_down_buy_interval_coeff = {p_risk_price_down_buy_interval_coeff} \nrisk_price_up_sell_interval_coeff = {p_risk_price_up_sell_interval_coeff} \n'.format(p_enable_trade_entry_bmo=self.enable_trade_entry_market_open_before, p_duration_trade_entry_bmo=self.duration_trade_entry_market_open_before, p_duration_trade_max_bmo=self.duration_trade_max_market_open_before, p_enable_trade_entry_amo=self.enable_trade_entry_market_open_after, p_duration_trade_entry_amo=self.duration_trade_entry_market_open_after, p_duration_trade_max_amo=self.duration_trade_max_market_open_after, p_enable_trade_entry_intra_day=self.enable_trade_entry_intra_day, p_time_trade_entry_intra_day=self.time_trade_entry_intra_day, p_duration_trade_entry_intra_day=self.duration_trade_entry_intra_day, p_duration_trade_max_intra_day=self.duration_trade_max_intra_day, p_enable_trade_entry_bmc=self.enable_trade_entry_market_close_before, p_duration_trade_entry_bmc=self.duration_trade_entry_market_close_before, p_duration_trade_max_bmc=self.duration_trade_max_market_close_before, p_enable_trade_entry_amc=self.enable_trade_entry_market_close_after, p_duration_trade_entry_amc=self.duration_trade_entry_market_close_after, p_duration_trade_max_amc=self.duration_trade_max_market_close_after, p_bid_price_buy_init_delta_coeff=self.bid_price_buy_init_delta_coeff, p_ask_price_sell_init_delta_coeff=self.ask_price_sell_init_delta_coeff, p_bid_price_buy_increase_delta_coeff=self.bid_price_buy_increase_delta_coeff, p_ask_price_sell_increase_delta_coeff=self.ask_price_sell_increase_delta_coeff, p_bid_price_buy_exit_delta_coeff=self.bid_price_buy_exit_delta_coeff, p_ask_price_sell_exit_delta_coeff=self.ask_price_sell_exit_delta_coeff, p_stop_price_init_interval_coeff_down_buy=self.stop_price_init_interval_coeff_down_buy, p_stop_price_init_interval_coeff_up_sell=self.stop_price_init_interval_coeff_up_sell, p_stop_price_trail_interval_coeff_down_buy=self.stop_price_trail_interval_coeff_down_buy, p_stop_price_trail_interval_coeff_up_sell=self.stop_price_trail_interval_coeff_up_sell, p_stop_price_trail_threshold_interval_coeff_down_buy=self.stop_price_trail_threshold_interval_coeff_down_buy, p_stop_price_trail_threshold_interval_coeff_up_sell=self.stop_price_trail_threshold_interval_coeff_up_sell, p_stop_price_trail_step_interval_coeff_down_buy=self.stop_price_trail_step_interval_coeff_down_buy, p_stop_price_trail_step_interval_coeff_up_sell=self.stop_price_trail_step_interval_coeff_up_sell, p_stop_price_trail_step_count_max_down_buy=self.stop_price_trail_step_count_max_down_buy, p_stop_price_trail_step_count_max_up_sell=self.stop_price_trail_step_count_max_up_sell, p_stop_price_trail_base_type=self.stop_price_trail_base_type, p_stop_price_trail_type=self.stop_price_trail_type, p_reward_risk_ratio_price_target_buy=self.reward_risk_ratio_price_target_buy, p_reward_risk_ratio_price_target_sell=self.reward_risk_ratio_price_target_sell, p_risk_price_down_buy_interval_coeff=self.risk_price_down_buy_interval_coeff, p_risk_price_up_sell_interval_coeff=self.risk_price_up_sell_interval_coeff)
        type(self).tracer_0.trace(self.symbol, 'log_trade_algo_params_per_symbol', 'parameters of trading algorithm', msg)
    except Exception as X:
        bErr = False
        sErr = STRING_FAILED
        msg = traceback.format_exc()
        type(self).tracer_0.trace(self.symbol, 'log_trade_algo_params_per_symbol', sErr, msg)
    finally:
        type(self).tracer_0.trace(self.symbol, 'log_trade_algo_params_per_symbol', sErr, LEXEM_FINALLY)
        return bErr</text></g>
<!-- node_bf80f456 -->
<g class="node" id="node24">
<title>node_bf80f456</title>
<path d="M527.5,-928C527.5,-928 279.5,-928 279.5,-928 273.5,-928 267.5,-922 267.5,-916 267.5,-916 267.5,-904 267.5,-904 267.5,-898 273.5,-892 279.5,-892 279.5,-892 527.5,-892 527.5,-892 533.5,-892 539.5,-898 539.5,-904 539.5,-904 539.5,-916 539.5,-916 539.5,-922 533.5,-928 527.5,-928" fill="#6db33f" stroke="black"></path>
<text font-family="Times New Roman,serif" font-size="14.00" text-anchor="middle" x="403.5" y="-906.3">1553: log_trade_on_fill_params_per_symbol()</text>
<text style="display:none;">def log_trade_on_fill_params_per_symbol(self, event_order_id):
    bErr = True
    sErr = STRING_SUCCESS
    try:
        if event_order_id == self.order_id_buy_init:
            msg = '\n algo_buy_init\nprice_high_day_since_on_fill = {p_price_high_day_since_on_fill} \nprice_on_fill_buy_init = {p_price_on_fill_buy_init} \nstop_price_down_buy = {p_stop_price_down_buy} \nstop_price_trail_threshold_buy = {p_stop_price_trail_threshold_buy} \nstop_price_trail_step_buy_count = {p_stop_price_trail_step_buy_count} \nprice_target_buy = {p_price_target_buy} \ntime_stop_trade_buy_on_fill_reference = {p_time_stop_trade_buy_on_fill_reference} \n'.format(p_price_high_day_since_on_fill=self.price_high_day_since_on_fill, p_price_on_fill_buy_init=self.price_on_fill_buy_init, p_stop_price_down_buy=self.stop_price_down_buy, p_stop_price_trail_threshold_buy=self.stop_price_trail_threshold_buy, p_stop_price_trail_step_buy_count=self.stop_price_trail_step_buy_count, p_price_target_buy=self.price_target_buy, p_time_stop_trade_buy_on_fill_reference=self.time_stop_trade_buy_on_fill_reference)
        elif event_order_id == self.order_id_buy_increase:
            msg = '\n algo_buy_increase\nprice_high_day_since_on_fill = {p_price_high_day_since_on_fill} \nprice_on_fill_buy_increase = {p_price_on_fill_buy_increase} \nstop_price_down_buy = {p_stop_price_down_buy} \nstop_price_trail_threshold_buy = {p_stop_price_trail_threshold_buy} \nstop_price_trail_step_buy_count = {p_stop_price_trail_step_buy_count} \nprice_target_buy = {p_price_target_buy} \ntime_stop_trade_buy_on_fill_reference = {p_time_stop_trade_buy_on_fill_reference} \n'.format(p_price_high_day_since_on_fill=self.price_high_day_since_on_fill, p_price_on_fill_buy_increase=self.price_on_fill_buy_increase, p_stop_price_down_buy=self.stop_price_down_buy, p_stop_price_trail_threshold_buy=self.stop_price_trail_threshold_buy, p_stop_price_trail_step_buy_count=self.stop_price_trail_step_buy_count, p_price_target_buy=self.price_target_buy, p_time_stop_trade_buy_on_fill_reference=self.time_stop_trade_buy_on_fill_reference)
        elif event_order_id == self.order_id_sell_init:
            msg = '\n algo_sell_init\nprice_high_day_since_on_fill = {p_price_high_day_since_on_fill} \nprice_on_fill_sell_init = {p_price_on_fill_sell_init} \nstop_price_up_sell = {p_stop_price_up_sell} \nstop_price_trail_threshold_sell = {p_stop_price_trail_threshold_sell} \nstop_price_trail_step_sell_count = {p_stop_price_trail_step_sell_count} \nprice_target_sell = {p_price_target_sell} \ntime_stop_trade_sell_on_fill_reference = {p_time_stop_trade_sell_on_fill_reference} \n'.format(p_price_high_day_since_on_fill=self.price_high_day_since_on_fill, p_price_on_fill_sell_init=self.price_on_fill_sell_init, p_stop_price_up_sell=self.stop_price_up_sell, p_stop_price_trail_threshold_sell=self.stop_price_trail_threshold_sell, p_stop_price_trail_step_sell_count=self.stop_price_trail_step_sell_count, p_price_target_sell=self.price_target_sell, p_time_stop_trade_sell_on_fill_reference=self.time_stop_trade_sell_on_fill_reference)
        elif event_order_id == self.order_id_sell_increase:
            msg = '\n algo_sell_increase\nprice_high_day_since_on_fill = {p_price_high_day_since_on_fill} \nprice_on_fill_sell_increase = {p_price_on_fill_sell_increase} \nstop_price_up_sell = {p_stop_price_up_sell} \nstop_price_trail_threshold_sell = {p_stop_price_trail_threshold_sell} \nstop_price_trail_step_sell_count = {p_stop_price_trail_step_sell_count} \nprice_target_sell = {p_price_target_sell} \ntime_stop_trade_sell_on_fill_reference = {p_time_stop_trade_sell_on_fill_reference} \n'.format(p_price_high_day_since_on_fill=self.price_high_day_since_on_fill, p_price_on_fill_sell_increase=self.price_on_fill_sell_increase, p_stop_price_up_sell=self.stop_price_up_sell, p_stop_price_trail_threshold_sell=self.stop_price_trail_threshold_sell, p_stop_price_trail_step_sell_count=self.stop_price_trail_step_sell_count, p_price_target_sell=self.price_target_sell, p_time_stop_trade_sell_on_fill_reference=self.time_stop_trade_sell_on_fill_reference)
        else:
            msg = '\n intent is decrease or exit \n'
        type(self).tracer_0.trace(self.symbol, 'log_trade_on_fill_params_per_symbol', 'on_fill parameters of trade algorithm', msg)
    except Exception as X:
        bErr = False
        sErr = STRING_FAILED
        msg = traceback.format_exc()
        type(self).tracer_0.trace(self.symbol, 'log_trade_on_fill_params_per_symbol', sErr, msg)</text></g>
<!-- node_2ad0869c -->
<g class="node" id="node25">
<title>node_2ad0869c</title>
<path d="M538.5,-746C538.5,-746 268.5,-746 268.5,-746 262.5,-746 256.5,-740 256.5,-734 256.5,-734 256.5,-722 256.5,-722 256.5,-716 262.5,-710 268.5,-710 268.5,-710 538.5,-710 538.5,-710 544.5,-710 550.5,-716 550.5,-722 550.5,-722 550.5,-734 550.5,-734 550.5,-740 544.5,-746 538.5,-746" fill="#6db33f" stroke="black"></path>
<text font-family="Times New Roman,serif" font-size="14.00" text-anchor="middle" x="403.5" y="-724.3">1509: log_trade_order_algo_params_per_symbol()</text>
<text style="display:none;">def log_trade_order_algo_params_per_symbol(self):
    bErr = True
    sErr = STRING_SUCCESS
    try:
        msg = '\n\ntrade_order_algo_type_buy_init        = {p_trade_order_algo_type_buy_init} \ntrade_order_algo_type_sell_init       = {p_trade_order_algo_type_sell_init} \ntrade_order_algo_type_buy_increase    = {p_trade_order_algo_type_buy_increase} \ntrade_order_algo_type_sell_increase   = {p_trade_order_algo_type_sell_increase} \ntrade_order_algo_type_buy_decrease    = {p_trade_order_algo_type_buy_decrease} \ntrade_order_algo_type_sell_decrease   = {p_trade_order_algo_type_sell_decrease} \ntrade_order_algo_type_buy_exit        = {p_trade_order_algo_type_buy_exit} \ntrade_order_algo_type_sell_exit       = {p_trade_order_algo_type_sell_exit} \n'.format(p_trade_order_algo_type_buy_init=self.trade_order_algo_type_buy_init, p_trade_order_algo_type_sell_init=self.trade_order_algo_type_sell_init, p_trade_order_algo_type_buy_increase=self.trade_order_algo_type_buy_increase, p_trade_order_algo_type_sell_increase=self.trade_order_algo_type_sell_increase, p_trade_order_algo_type_buy_decrease=self.trade_order_algo_type_buy_decrease, p_trade_order_algo_type_sell_decrease=self.trade_order_algo_type_sell_decrease, p_trade_order_algo_type_buy_exit=self.trade_order_algo_type_buy_exit, p_trade_order_algo_type_sell_exit=self.trade_order_algo_type_sell_exit)
        type(self).tracer_0.trace(self.symbol, 'log_trade_order_algo_params_per_symbol', 'parameters of risk management algorithm', msg)
    except Exception as X:
        bErr = False
        sErr = STRING_FAILED
        msg = traceback.format_exc()
        type(self).tracer_0.trace(self.symbol, 'log_trade_order_algo_params_per_symbol', sErr, msg)
    finally:
        type(self).tracer_0.trace(self.symbol, 'log_trade_order_algo_params_per_symbol', sErr, LEXEM_FINALLY)
        return bErr</text></g>
<!-- node_6279df72 -->
<g class="node" id="node26">
<title>node_6279df72</title>
<path d="M453,-60C453,-60 354,-60 354,-60 348,-60 342,-54 342,-48 342,-48 342,-36 342,-36 342,-30 348,-24 354,-24 354,-24 453,-24 453,-24 459,-24 465,-30 465,-36 465,-36 465,-48 465,-48 465,-54 459,-60 453,-60" fill="#cccccc" stroke="black"></path>
<text font-family="Times New Roman,serif" font-size="14.00" text-anchor="middle" x="403.5" y="-38.3">2162: on_dev_evt()</text>
<text style="display:none;">def on_dev_evt(self, event, md, order, service, account):
    sErr = STRING_SUCCESS
    try:
        self.time_server_receive = service.system_time
        msg = 'received_event'
        type(self).tracer_0.trace(md.symbol, 'on_dev_evt', 'debug_00', msg)
        if 'msg_id' in event.field:
            msg_id = ''
            msg_type = ''
            signal_type = ''
            signal_value = ''
            if 'msg_id' in event.field:
                msg_id = event.field['msg_id']
            if 'msg_type' in event.field:
                msg_type = event.field['msg_type']
            if 'signal_type' in event.field:
                signal_type = event.field['signal_type']
            if 'signal_value' in event.field:
                signal_value = event.field['signal_value']
            msg = 'msg_id {p_msg_id}  msg_type {p_msg_type}  singal_type {p_signal_type}  signal_value {p_signal_value}'.format(p_msg_id=msg_id, p_msg_type=msg_type, p_signal_type=signal_type, p_signal_value=signal_value)
            type(self).tracer_0.trace(md.symbol, 'on_dev_evt', 'trade_signal', msg)
            if msg_id == 'pd_001':
                if msg_type == 'signal':
                    if signal_type == 'buy':
                        self.estimate_time_interval(md, order, service, account)
                        if self.enable_trade_entry:
                            self.algo_buy_init(md, order, service, account)
                    elif signal_type == 'sell':
                        self.estimate_time_interval(md, order, service, account)
                        if self.enable_trade_entry:
                            self.algo_sell_init(md, order, service, account)
                elif msg_type == 'command':
                    self.execute_command(md, order, service, account)
                elif msg_type == 'check_active':
                    type(self).tracer_0.trace(md.symbol, 'on_dev_evt', 'message', 'received: check_active')
    except Exception as X:
        sErr = STRING_FAILED
        msg = traceback.format_exc()
        type(self).tracer_0.trace(md.symbol, 'on_dev_evt', sErr, msg)
    finally:
        type(self).tracer_0.trace(md.symbol, 'on_dev_evt', sErr, LEXEM_FINALLY)</text></g>
<!-- node_6279df72&#45;&gt;node_3802d94e -->
<g class="edge" id="edge11">
<title>node_6279df72-&gt;node_3802d94e</title>
<path d="M465.14,-31.2C465.14,-31.2 720.18,-31.2 720.18,-31.2" fill="none" stroke="#56b4e9" stroke-width="2"></path>
<polygon fill="#56b4e9" points="720.18,-34.7 730.18,-31.2 720.18,-27.7 720.18,-34.7" stroke="#56b4e9" stroke-width="2"></polygon>
</g>
<!-- node_6279df72&#45;&gt;node_5a11f6bf -->
<g class="edge" id="edge12">
<title>node_6279df72-&gt;node_5a11f6bf</title>
<path d="M465.14,-52.8C488.7,-52.8 510,-52.8 510,-52.8 510,-52.8 510,-150 510,-150 510,-150 720.84,-150 720.84,-150" fill="none" stroke="#56b4e9" stroke-width="2"></path>
<polygon fill="#56b4e9" points="720.84,-153.5 730.84,-150 720.84,-146.5 720.84,-153.5" stroke="#56b4e9" stroke-width="2"></polygon>
</g>
<!-- node_6279df72&#45;&gt;node_5749ec83 -->
<g class="edge" id="edge13">
<title>node_6279df72-&gt;node_5749ec83</title>
<path d="M465.36,-45.6C555.15,-45.6 711,-45.6 711,-45.6 711,-45.6 711,-175.83 711,-175.83" fill="none" stroke="#56b4e9" stroke-width="2"></path>
<polygon fill="#56b4e9" points="707.5,-175.83 711,-185.83 714.5,-175.83 707.5,-175.83" stroke="#56b4e9" stroke-width="2"></polygon>
</g>
<!-- node_6279df72&#45;&gt;node_dd4d60f4 -->
<g class="edge" id="edge15">
<title>node_6279df72-&gt;node_dd4d60f4</title>
<path d="M465.3,-38.4C558.43,-38.4 724,-38.4 724,-38.4 724,-38.4 724,-67.78 724,-67.78" fill="none" stroke="#56b4e9" stroke-width="2"></path>
<polygon fill="#56b4e9" points="720.5,-67.77 724,-77.78 727.5,-67.78 720.5,-67.77" stroke="#56b4e9" stroke-width="2"></polygon>
</g>
<!-- node_4d8a5f6c -->
<g class="node" id="node27">
<title>node_4d8a5f6c</title>
<path d="M149.5,-928C149.5,-928 77.5,-928 77.5,-928 71.5,-928 65.5,-922 65.5,-916 65.5,-916 65.5,-904 65.5,-904 65.5,-898 71.5,-892 77.5,-892 77.5,-892 149.5,-892 149.5,-892 155.5,-892 161.5,-898 161.5,-904 161.5,-904 161.5,-916 161.5,-916 161.5,-922 155.5,-928 149.5,-928" fill="#966f33" stroke="black"></path>
<text font-family="Times New Roman,serif" font-size="14.00" text-anchor="middle" x="113.5" y="-906.3">2015: on_fill()</text>
<text style="display:none;">def on_fill(self, event, md, order, service, account):
    if event.intent == 'init':
        self.price_stop_trail_base = md.L1.last
        self.price_high_day_since_on_fill = self.price_stop_trail_base
        if event.order_id == self.order_id_buy_init:
            self.price_on_fill_buy_init = event.price
            if not self.is_stop_price_down_buy_set:
                self.stop_price_down_buy = self.price_on_fill_buy_init * (1 - self.stop_price_init_interval_coeff_down_buy)
                self.is_stop_price_down_buy_set = True
            if not self.is_stop_price_trail_threshold_buy_set:
                self.stop_price_trail_threshold_buy = self.price_on_fill_buy_init * (1 + self.stop_price_trail_threshold_interval_coeff_down_buy)
                self.stop_price_trail_step_buy_count = 0
                self.is_stop_price_trail_threshold_buy_set = True
            self.price_target_buy = self.price_on_fill_buy_init * (1 + self.risk_price_down_buy_interval_coeff * self.reward_risk_ratio_price_target_buy)
            self.time_stop_trade_buy_on_fill_reference = md.L1.timestamp + self.duration_trade_max
            self.is_order_buy_init_filled = True
        elif event.order_id == self.order_id_sell_init:
            self.price_on_fill_sell_init = event.price
            if not self.is_stop_price_up_sell_set:
                self.stop_price_up_sell = self.price_on_fill_sell_init * (1 + self.stop_price_init_interval_coeff_up_sell)
                self.is_stop_price_up_sell_set = True
            if not self.is_stop_price_trail_threshold_sell_set:
                self.stop_price_trail_threshold_sell = self.price_on_fill_sell_init * (1 - self.stop_price_trail_threshold_interval_coeff_up_sell)
                self.stop_price_trail_step_sell_count = 0
                self.is_stop_price_trail_threshold_sell_set = True
            self.price_target_sell = self.price_on_fill_sell_init * (1 - self.risk_price_up_sell_interval_coeff * self.reward_risk_ratio_price_target_sell)
            self.time_stop_trade_sell_on_fill_reference = md.L1.timestamp + self.duration_trade_max
            self.is_order_sell_init_filled = True
    if event.intent == 'increase':
        self.price_stop_trail_base = md.L1.last
        self.price_high_day_since_on_fill = self.price_stop_trail_base
        if event.order_id == self.order_id_buy_increase:
            self.price_on_fill_buy_increase = event.price
            if not self.is_stop_price_down_buy_set:
                self.stop_price_down_buy = self.price_on_fill_buy_increase * (1 - self.stop_price_init_interval_coeff_down_buy)
                self.is_stop_price_down_buy_set = True
            if not self.is_stop_price_trail_threshold_buy_set:
                self.stop_price_trail_threshold_buy = self.price_on_fill_buy_increase * (1 + self.stop_price_trail_threshold_interval_coeff_down_buy)
                self.stop_price_trail_step_buy_count = 0
                self.is_stop_price_trail_threshold_buy_set = True
            self.price_target_buy = self.price_on_fill_buy_increase * (1 + self.risk_price_down_buy_interval_coeff * self.reward_risk_ratio_price_target_buy)
            self.time_stop_trade_buy_on_fill_reference = md.L1.timestamp + self.duration_trade_max
            self.is_order_buy_increase_filled = True
        elif event.order_id == self.order_id_sell_increase:
            self.price_on_fill_sell_increase = event.price
            if not self.is_stop_price_up_sell_set:
                self.stop_price_up_sell = self.price_on_fill_sell_increase * (1 + self.stop_price_init_interval_coeff_up_sell)
                self.is_stop_price_up_sell_set = True
            if not self.is_stop_price_trail_threshold_sell_set:
                self.stop_price_trail_threshold_sell = self.price_on_fill_sell_increase * (1 - self.stop_price_trail_threshold_interval_coeff_up_sell)
                self.stop_price_trail_step_sell_count = 0
                self.is_stop_price_trail_threshold_sell_set = True
            self.price_target_sell = self.price_on_fill_sell_increase * (1 - self.risk_price_up_sell_interval_coeff * self.reward_risk_ratio_price_target_sell)
            self.time_stop_trade_sell_on_fill_reference = md.L1.timestamp + self.duration_trade_max
            self.is_order_sell_increase_filled = True
    elif event.intent == 'decrease' or event.intent == 'exit':
        if event.order_id == self.order_id_buy_decrease:
            self.is_order_buy_decrease_filled = True
        elif event.order_id == self.order_id_sell_decrease:
            self.is_order_sell_decrease_filled = True
    msg = 'order_id={p_order_id}  state={p_state} intent={p_intent}  act_direct={p_act_direct}  shares={p_shares}  price={p_price}'.format(p_order_id=event.order_id, p_state=event.state, p_intent=event.intent, p_act_direct=event.actual_direction, p_shares=event.shares, p_price=event.price)
    type(self).tracer_0.trace(self.symbol, 'on_fill', 'debug_0', msg)
    if type(self).enable_log_trade_on_fill_params_per_symbol_cfg:
        if event.intent == 'init' or event.intent == 'increase':
            self.log_trade_on_fill_params_per_symbol(event.order_id)
    if type(self).enable_alerter_this_script:
        msg_date_time = service.time_to_string(service.system_time, format='%Y-%m-%d %H:%M:%S.%f')
        msg_acc_pos_shares = event.shares
        msg_last_price = '{p_last_price:&gt;12.4f}'.format(p_last_price=event.price)
        msg_intent = event.intent
        msg_act_direction = event.actual_direction
        msg_note = ''
        type(self).alerter_this_script.Send(self.symbol, [msg_date_time, msg_acc_pos_shares, msg_last_price, msg_intent, msg_act_direction, msg_note])</text></g>
<!-- node_4d8a5f6c&#45;&gt;node_bf80f456 -->
<g class="edge" id="edge16">
<title>node_4d8a5f6c-&gt;node_bf80f456</title>
<path d="M161.71,-910C161.71,-910 257.24,-910 257.24,-910" fill="none" stroke="#f0e442" stroke-width="2"></path>
<polygon fill="#f0e442" points="257.24,-913.5 267.24,-910 257.24,-906.5 257.24,-913.5" stroke="#f0e442" stroke-width="2"></polygon>
</g>
<!-- node_a9cc2ae8 -->
<g class="node" id="node28">
<title>node_a9cc2ae8</title>
<path d="M150,-692C150,-692 77,-692 77,-692 71,-692 65,-686 65,-680 65,-680 65,-668 65,-668 65,-662 71,-656 77,-656 77,-656 150,-656 150,-656 156,-656 162,-662 162,-668 162,-668 162,-680 162,-680 162,-686 156,-692 150,-692" fill="#966f33" stroke="black"></path>
<text font-family="Times New Roman,serif" font-size="14.00" text-anchor="middle" x="113.5" y="-670.3">880: on_start()</text>
<text style="display:none;">def on_start(self, md, order, service, account):
    sErr = STRING_SUCCESS
    try:
        self.start_timer_time = service.system_time + service.time_interval(0, 1, 0, 0)
        self.on_timer(self.start_timer_time, service.time_interval(0, 1, 0, 0))
        self.time_server_send = 0
        self.time_server_receive = 0
        self.time_server_roundtrip = 0
        self.time_client_receive = 0
        if not self.on_start_akt_pd_trade(md, order, service, account):
            sErr = STRING_FAILED
            return
        self.time_exit_trade_all = md.market_close_time - service.time_interval(0, 0, 0, self.duration_exit_trade_all_market_close_before)
        delta_time = service.time_interval(0, 0, 0, self.duration_exit_trade_all_market_close_before)
        msg = '\nmarket_close_time = {p_market_close_time} \nduration_exit_trade_all_market_close_before = {p_duration_exit_trade_all_market_close_before} \ntime_exit_trade_all = {p_time_exit_trade_all} \ndelta_time = {p_delta_time} \n'.format(p_market_close_time=md.market_close_time, p_duration_exit_trade_all_market_close_before=self.duration_exit_trade_all_market_close_before, p_time_exit_trade_all=self.time_exit_trade_all, p_delta_time=delta_time)
        type(self).tracer_0.trace(md.symbol, 'on_start', 'debug_0', msg)
        self.price = 0.0
        self.price_high_day_since_on_fill = 0.0
        self.price_stop_trail_base = 0.0
        self.price_stop_trail_base_high_since_on_fill = False
        self.order_type = ''
        self.order_price = 0.0
        self.order_quantity = 0
        self.order_id = ''
        self.initialize_order_long()
        self.initialize_order_short()
        self.count_on_timer_debug = 0
        if type(self).enable_log_trade_algo_params_per_symbol_cfg:
            self.log_trade_algo_params_per_symbol()
        if type(self).enable_log_risk_management_algo_params_per_symbol_cfg:
            self.log_risk_management_algo_params_per_symbol()
        if type(self).enable_log_trade_order_algo_params_per_symbol_cfg:
            self.log_trade_order_algo_params_per_symbol()
    except Exception as X:
        sErr = STRING_FAILED
        msg = traceback.format_exc()
        type(self).tracer_0.trace(md.symbol, 'on_start', sErr, msg)
    finally:
        type(self).tracer_0.trace(md.symbol, 'on_start', sErr, LEXEM_FINALLY)</text></g>
<!-- node_a9cc2ae8&#45;&gt;node_d0b12c38 -->
<g class="edge" id="edge17">
<title>node_a9cc2ae8-&gt;node_d0b12c38</title>
<path d="M130,-692.09C130,-715.13 130,-752 130,-752 130,-752 701.36,-752 701.36,-752" fill="none" stroke="#000000" stroke-width="2"></path>
<polygon fill="#000000" points="701.36,-755.5 711.36,-752 701.36,-748.5 701.36,-755.5" stroke="#000000" stroke-width="2"></polygon>
</g>
<!-- node_a9cc2ae8&#45;&gt;node_7b0a0283 -->
<g class="edge" id="edge18">
<title>node_a9cc2ae8-&gt;node_7b0a0283</title>
<path d="M98,-655.76C98,-627.66 98,-577 98,-577 98,-577 699.7,-577 699.7,-577" fill="none" stroke="#000000" stroke-width="2"></path>
<polygon fill="#000000" points="699.7,-580.5 709.7,-577 699.7,-573.5 699.7,-580.5" stroke="#000000" stroke-width="2"></polygon>
</g>
<!-- node_a9cc2ae8&#45;&gt;node_bc890cbb -->
<g class="edge" id="edge19">
<title>node_a9cc2ae8-&gt;node_bc890cbb</title>
<path d="M162.06,-665C200.58,-665 248,-665 248,-665 248,-665 248,-574.07 248,-574.07" fill="none" stroke="#000000" stroke-width="2"></path>
<polygon fill="#000000" points="251.5,-574.07 248,-564.07 244.5,-574.07 251.5,-574.07" stroke="#000000" stroke-width="2"></polygon>
</g>
<!-- node_a9cc2ae8&#45;&gt;node_4c9031b0 -->
<g class="edge" id="edge20">
<title>node_a9cc2ae8-&gt;node_4c9031b0</title>
<path d="M162.04,-674C162.04,-674 263.78,-674 263.78,-674" fill="none" stroke="#000000" stroke-width="2"></path>
<polygon fill="#000000" points="263.78,-677.5 273.78,-674 263.78,-670.5 263.78,-677.5" stroke="#000000" stroke-width="2"></polygon>
</g>
<!-- node_a9cc2ae8&#45;&gt;node_2ad0869c -->
<g class="edge" id="edge21">
<title>node_a9cc2ae8-&gt;node_2ad0869c</title>
<path d="M162.17,-683C206.8,-683 266,-683 266,-683 266,-683 266,-699.96 266,-699.96" fill="none" stroke="#000000" stroke-width="2"></path>
<polygon fill="#000000" points="262.5,-699.96 266,-709.96 269.5,-699.96 262.5,-699.96" stroke="#000000" stroke-width="2"></polygon>
</g>
<!-- node_eef70501 -->
<g class="node" id="node29">
<title>node_eef70501</title>
<path d="M478.5,-874C478.5,-874 328.5,-874 328.5,-874 322.5,-874 316.5,-868 316.5,-862 316.5,-862 316.5,-850 316.5,-850 316.5,-844 322.5,-838 328.5,-838 328.5,-838 478.5,-838 478.5,-838 484.5,-838 490.5,-844 490.5,-850 490.5,-850 490.5,-862 490.5,-862 490.5,-868 484.5,-874 478.5,-874" fill="#cccccc" stroke="black"></path>
<text font-family="Times New Roman,serif" font-size="14.00" text-anchor="middle" x="403.5" y="-852.3">965: on_start_akt_pd_trade()</text>
<text style="display:none;">def on_start_akt_pd_trade(self, md, order, service, account):
    bErr = True
    sErr = STRING_SUCCESS
    try:
        self.market_open_time = md.market_open_time
        self.market_close_time = md.market_close_time
        self.initialize_trading_algorithm_params_for_symbol(md, order, service, account)
        self.initialize_risk_management_algorithm_params_for_symbol(md, order, service, account)
        self.initialize_trading_order_algorithm_params_for_symbol(md, order, service, account)
        self.time_trade_entry_start_bmo = self.market_open_time - self.duration_trade_entry_market_open_before
        self.time_trade_entry_stop_bmo = self.market_open_time
        self.time_trade_entry_start_amo = self.market_open_time
        self.time_trade_entry_stop_amo = self.market_open_time + self.duration_trade_entry_market_open_after
        self.time_trade_entry_start_intra_day = self.market_open_time + self.time_trade_entry_intra_day
        self.time_trade_entry_stop_intra_day = self.time_trade_entry_start_intra_day + self.duration_trade_entry_intra_day
        self.time_trade_entry_start_bmc = self.market_close_time - self.duration_trade_entry_market_close_before
        self.time_trade_entry_stop_bmc = self.market_close_time
        self.time_trade_entry_start_amc = self.market_close_time
        self.time_trade_entry_stop_amc = self.market_close_time + self.duration_trade_entry_market_close_after
        if self.time_trade_entry_stop_amo &gt; self.market_close_time:
            self.time_trade_entry_stop_amo = self.market_close_time
        if self.time_trade_entry_start_intra_day &lt; self.market_open_time:
            self.time_trade_entry_start_intra_day = self.market_open_time
        if self.time_trade_entry_stop_intra_day &gt; self.market_close_time:
            self.time_trade_entry_stop_intra_day = self.market_close_time
        if self.time_trade_entry_start_bmc &lt; self.market_open_time:
            self.time_trade_entry_start_bmc = self.market_open_time
        if self.time_trade_entry_start_intra_day &lt; self.time_trade_entry_stop_amo:
            self.time_trade_entry_start_intra_day = self.time_trade_entry_stop_amo
        if self.time_trade_entry_stop_intra_day &gt; self.time_trade_entry_start_bmc:
            self.time_trade_entry_stop_intra_day = self.time_trade_entry_start_bmc
        self.enable_trade_entry = False
        self.time_trade_entry_start = 0
        self.time_trade_entry_stop = 0
        self.duration_trade_max = 0
        self.index_trade_interval = 0
        self.time_trade_entry_start_found = False
        if self.enable_trade_entry_market_open_before and self.duration_trade_entry_market_open_before &gt; 0:
            self.time_trade_entry_start = self.time_trade_entry_start_bmo
            self.time_trade_entry_stop = self.time_trade_entry_stop_bmo
            self.duration_trade_max = self.duration_trade_max_market_open_before
            self.index_trade_interval = 1
            self.time_trade_entry_start_found = True
        if not self.time_trade_entry_start_found:
            if self.enable_trade_entry_market_open_after and self.duration_trade_entry_market_open_after &gt; 0:
                self.time_trade_entry_start = self.time_trade_entry_start_amo
                self.time_trade_entry_stop = self.time_trade_entry_stop_amo
                self.duration_trade_max = self.duration_trade_max_market_open_after
                self.index_trade_interval = 2
                self.time_trade_entry_start_found = True
        if not self.time_trade_entry_start_found:
            if self.enable_trade_entry_intra_day and self.duration_trade_entry_intra_day &gt; 0:
                self.time_trade_entry_start = self.time_trade_entry_start_intra_day
                self.time_trade_entry_stop = self.time_trade_entry_stop_intra_day
                self.duration_trade_max = self.duration_trade_max_intra_day
                self.index_trade_interval = 3
                self.time_trade_entry_start_found = True
        if not self.time_trade_entry_start_found:
            if self.enable_trade_entry_market_close_before and self.duration_trade_entry_market_close_before &gt; 0:
                self.time_trade_entry_start = self.time_trade_entry_start_bmc
                self.time_trade_entry_stop = self.time_trade_entry_stop_bmc
                self.duration_trade_max = self.duration_trade_max_market_close_before
                self.index_trade_interval = 4
                self.time_trade_entry_start_found = True
        if not self.time_trade_entry_start_found:
            if self.enable_trade_entry_market_close_after and self.duration_trade_entry_market_close_after &gt; 0:
                self.time_trade_entry_start = self.time_trade_entry_start_amc
                self.time_trade_entry_stop = self.time_trade_entry_stop_amc
                self.duration_trade_max = self.duration_trade_max_market_close_after
                self.index_trade_interval = 5
                self.time_trade_entry_start_found = True
        self.buying_power_total = type(self).buying_power_total_cfg
        self.buying_power_per_order_max = type(self).buying_power_per_order_cfg
        self.buying_power_per_position_max = type(self).buying_power_per_position_cfg
        self.shares_per_order_max = type(self).shares_per_order_max_cfg
        self.shares_per_position_max = type(self).shares_per_position_max_cfg
        self.buying_power_per_order = self.buying_power_per_order_max * self.buying_power_per_order_init_coeff
        self.buying_power_per_position = self.buying_power_per_position_max * self.buying_power_per_position_init_coeff
        self.shares_per_order = self.shares_per_order_max * self.shares_per_order_max_init_coeff
        self.shares_per_position = self.shares_per_position_max * self.shares_per_position_max_init_coeff
        if self.buying_power_per_order &lt; 0 or self.buying_power_per_order &gt; self.buying_power_per_order_max:
            self.buying_power_per_order = self.buying_power_per_order_max
        if self.buying_power_per_position &lt; 0 or self.buying_power_per_position &gt; self.buying_power_per_position_max:
            self.buying_power_per_position = self.buying_power_per_position_max
        if self.shares_per_order &lt; 0 or self.shares_per_order &gt; self.shares_per_order_max:
            self.shares_per_order = self.shares_per_order_max
        if self.shares_per_position &lt; 0 or self.shares_per_position &gt; self.shares_per_position_max:
            self.shares_per_position = self.shares_per_position_max
        self.duration_exit_trade_all_market_close_before = type(self).duration_exit_trade_all_market_close_before_cfg
    except Exception as X:
        bErr = False
        sErr = STRING_FAILED
        msg = traceback.format_exc()
        type(self).tracer_0.trace(md.symbol, 'on_start_akt_pd_trade', sErr, msg)
    finally:
        type(self).tracer_0.trace(md.symbol, 'on_start_akt_pd_trade', sErr, LEXEM_FINALLY)
        return bErr</text></g>
<!-- node_a9cc2ae8&#45;&gt;node_eef70501 -->
<g class="edge" id="edge22">
<title>node_a9cc2ae8-&gt;node_eef70501</title>
<path d="M98,-692.12C98,-738.15 98,-856 98,-856 98,-856 306.36,-856 306.36,-856" fill="none" stroke="#000000" stroke-width="2"></path>
<polygon fill="#000000" points="306.36,-859.5 316.36,-856 306.36,-852.5 306.36,-859.5" stroke="#000000" stroke-width="2"></polygon>
</g>
<!-- node_fb7f02f5 -->
<g class="node" id="node31">
<title>node_fb7f02f5</title>
<path d="M446.5,-638C446.5,-638 360.5,-638 360.5,-638 354.5,-638 348.5,-632 348.5,-626 348.5,-626 348.5,-614 348.5,-614 348.5,-608 354.5,-602 360.5,-602 360.5,-602 446.5,-602 446.5,-602 452.5,-602 458.5,-608 458.5,-614 458.5,-614 458.5,-626 458.5,-626 458.5,-632 452.5,-638 446.5,-638" fill="#cccccc" stroke="black"></path>
<text font-family="Times New Roman,serif" font-size="14.00" text-anchor="middle" x="403.5" y="-616.3">1712: on_timer()</text>
<text style="display:none;">def on_timer(self, event, md, order, service, account):
    sErr = STRING_SUCCESS
    try:
        self.price = md.L1.last
        if self.is_order_buy_init_filled or self.is_order_sell_init_filled or self.is_order_buy_increase_filled or self.is_order_sell_increase_filled:
            if self.stop_price_trail_base_type == aktpdtrprm.STOP_PRICE_TRAIL_BASE_TYPE_LAST_PRICE:
                self.price_stop_trail_base = self.price
            elif self.stop_price_trail_base_type == aktpdtrprm.STOP_PRICE_TRAIL_BASE_TYPE_HIGH_PRICE_SINCE_ON_FILL:
                if self.price &gt; self.price_high_day_since_on_fill:
                    self.price_high_day_since_on_fill = self.price
                self.price_stop_trail_base = self.price_high_day_since_on_fill
            else:
                self.price_stop_trail_base = self.price
        if self.is_order_buy_init_filled or self.is_order_buy_increase_filled:
            if self.is_stop_price_down_buy_set:
                if self.price &lt; self.stop_price_down_buy:
                    if account[self.symbol].position.shares &gt; 0:
                        self.algo_sell_exit(md, order, service, account)
                        if type(self).enable_log_trade_exit_params_per_symbol_cfg:
                            msg = 'self.price &lt; self.stop_price_down_buy'
                            type(self).tracer_0.trace(md.symbol, 'on_timer', 'algo_sell_exit', msg)
                elif self.price &gt; self.stop_price_down_buy:
                    if self.stop_price_trail_type == aktpdtrprm.STOP_PRICE_TRAIL_TYPE_CONTINUOUS:
                        stop_price_down_buy_new = self.price - self.price_stop_trail_base * self.stop_price_trail_interval_coeff_down_buy
                        if stop_price_down_buy_new &gt; self.stop_price_down_buy:
                            self.stop_price_down_buy = stop_price_down_buy_new
                    if self.stop_price_trail_type == aktpdtrprm.STOP_PRICE_TRAIL_TYPE_STEP:
                        if self.price &gt; self.stop_price_trail_threshold_buy:
                            if self.stop_price_trail_step_buy_count &lt; self.stop_price_trail_step_count_max_down_buy:
                                self.stop_price_down_buy += self.stop_price_trail_step_interval_coeff_down_buy
                                self.stop_price_trail_threshold_buy += self.stop_price_trail_step_interval_coeff_down_buy
                                self.stop_price_trail_step_buy_count += 1
                else:
                    pass
            if self.price &gt; self.price_target_buy:
                if account[self.symbol].position.shares &gt; 0:
                    self.algo_sell_exit(md, order, service, account)
                    if type(self).enable_log_trade_exit_params_per_symbol_cfg:
                        msg = 'self.price &gt; self.price_target_buy'
                        type(self).tracer_0.trace(md.symbol, 'on_timer', 'algo_sell_exit', msg)
            if md.L1.timestamp &gt; self.time_stop_trade_buy_on_fill_reference:
                if account[self.symbol].position.shares &gt; 0:
                    self.algo_sell_exit(md, order, service, account)
                    if type(self).enable_log_trade_exit_params_per_symbol_cfg:
                        msg = 'smd.L1.timestamp &gt; self.time_stop_trade_buy_on_fill_reference'
                        type(self).tracer_0.trace(md.symbol, 'on_timer', 'algo_sell_exit', msg)
        elif self.is_order_sell_init_filled or self.is_order_sell_increase_filled:
            if self.is_stop_price_up_sell_set:
                if self.price &gt; self.stop_price_up_sell:
                    if account[self.symbol].position.shares &lt; 0:
                        self.algo_buy_exit(md, order, service, account)
                        if type(self).enable_log_trade_exit_params_per_symbol_cfg:
                            msg = 'self.price &gt; self.stop_price_up_sell'
                            type(self).tracer_0.trace(md.symbol, 'on_timer', 'algo_buy_exit', msg)
                elif self.price &lt; self.stop_price_up_sell:
                    if self.stop_price_trail_type == aktpdtrprm.STOP_PRICE_TRAIL_TYPE_CONTINUOUS:
                        stop_price_up_sell_new = self.price + self.price_stop_trail_base * self.stop_price_trail_interval_coeff_up_sell
                        if stop_price_up_sell_new &lt; self.stop_price_up_sell:
                            self.stop_price_up_sell = stop_price_up_sell_new
                    if self.stop_price_trail_type == aktpdtrprm.STOP_PRICE_TRAIL_TYPE_STEP:
                        if self.price &lt; self.stop_price_trail_threshold_sell:
                            if self.stop_price_trail_step_sell_count &lt; self.stop_price_trail_step_count_max_up_sell:
                                self.stop_price_up_sell -= self.stop_price_trail_step_interval_coeff_up_sell
                                self.stop_price_trail_threshold_sell -= self.stop_price_trail_step_interval_coeff_up_sell
                                self.stop_price_trail_step_sell_count += 1
                else:
                    pass
            if self.price &lt; self.price_target_sell:
                if account[self.symbol].position.shares &lt; 0:
                    self.algo_buy_exit(md, order, service, account)
                    if type(self).enable_log_trade_exit_params_per_symbol_cfg:
                        msg = 'self.price &lt; self.price_target_sell'
                        type(self).tracer_0.trace(md.symbol, 'on_timer', 'algo_buy_exit', msg)
            if md.L1.timestamp &gt; self.time_stop_trade_sell_on_fill_reference:
                if account[self.symbol].position.shares &lt; 0:
                    self.algo_buy_exit(md, order, service, account)
                    if type(self).enable_log_trade_exit_params_per_symbol_cfg:
                        msg = 'md.L1.timestamp &gt; self.time_stop_trade_sell_on_fill_reference'
                        type(self).tracer_0.trace(md.symbol, 'on_timer', 'algo_buy_exit', msg)
        if account[md.symbol].position.shares == 0:
            if account[md.symbol].pending.shares_long == 0:
                if self.is_order_buy_decrease_filled:
                    if self.order_id_buy_decrease != '':
                        self.initialize_order_long()
            if account[md.symbol].pending.shares_short == 0:
                if self.is_order_sell_decrease_filled:
                    if self.order_id_sell_decrease != '':
                        self.initialize_order_short()
        elif md.L1.timestamp &gt; self.time_exit_trade_all:
            if account[self.symbol].position.shares &gt; 0:
                self.algo_sell_exit(md, order, service, account)
                if type(self).enable_log_trade_exit_params_per_symbol_cfg:
                    msg = 'md.L1.timestamp &gt; self.time_exit_trade_all'
                    type(self).tracer_0.trace(md.symbol, 'on_timer', 'algo_sell_exit', msg)
            if account[self.symbol].position.shares &lt; 0:
                self.algo_buy_exit(md, order, service, account)
                if type(self).enable_log_trade_exit_params_per_symbol_cfg:
                    msg = 'md.L1.timestamp &gt; self.time_exit_trade_all'
                    type(self).tracer_0.trace(md.symbol, 'on_timer', 'algo_buy_exit', msg)
    except Exception as X:
        sErr = STRING_FAILED
        msg = traceback.format_exc()
        type(self).tracer_0.trace(md.symbol, 'on_timer', sErr, msg)</text></g>
<!-- node_a9cc2ae8&#45;&gt;node_fb7f02f5 -->
<g class="edge" id="edge23">
<title>node_a9cc2ae8-&gt;node_fb7f02f5</title>
<path d="M130,-655.72C130,-640.05 130,-620 130,-620 130,-620 338.48,-620 338.48,-620" fill="none" stroke="#000000" stroke-width="2"></path>
<polygon fill="#000000" points="338.48,-623.5 348.48,-620 338.48,-616.5 338.48,-623.5" stroke="#000000" stroke-width="2"></polygon>
</g>
<!-- node_eef70501&#45;&gt;node_2e67684e -->
<g class="edge" id="edge24">
<title>node_eef70501-&gt;node_2e67684e</title>
<path d="M490.56,-850C490.56,-850 593.7,-850 593.7,-850" fill="none" stroke="#e69f00" stroke-width="2"></path>
<polygon fill="#e69f00" points="593.7,-853.5 603.7,-850 593.7,-846.5 593.7,-853.5" stroke="#e69f00" stroke-width="2"></polygon>
</g>
<!-- node_eef70501&#45;&gt;node_ca9d1adf -->
<g class="edge" id="edge25">
<title>node_eef70501-&gt;node_ca9d1adf</title>
<path d="M490.7,-862C519.82,-862 545,-862 545,-862 545,-862 545,-910 545,-910 545,-910 623.49,-910 623.49,-910" fill="none" stroke="#e69f00" stroke-width="2"></path>
<polygon fill="#e69f00" points="623.49,-913.5 633.49,-910 623.49,-906.5 623.49,-913.5" stroke="#e69f00" stroke-width="2"></polygon>
</g>
<!-- node_eef70501&#45;&gt;node_0de43f5d -->
<g class="edge" id="edge26">
<title>node_eef70501-&gt;node_0de43f5d</title>
<path d="M474,-837.82C474,-824.96 474,-810 474,-810 474,-810 605.64,-810 605.64,-810" fill="none" stroke="#e69f00" stroke-width="2"></path>
<polygon fill="#e69f00" points="605.64,-813.5 615.64,-810 605.64,-806.5 605.64,-813.5" stroke="#e69f00" stroke-width="2"></polygon>
</g>
<!-- node_bfd8e7f9 -->
<g class="node" id="node30">
<title>node_bfd8e7f9</title>
<path d="M174.5,-294C174.5,-294 52.5,-294 52.5,-294 46.5,-294 40.5,-288 40.5,-282 40.5,-282 40.5,-270 40.5,-270 40.5,-264 46.5,-258 52.5,-258 52.5,-258 174.5,-258 174.5,-258 180.5,-258 186.5,-264 186.5,-270 186.5,-270 186.5,-282 186.5,-282 186.5,-288 180.5,-294 174.5,-294" fill="#966f33" stroke="black"></path>
<text font-family="Times New Roman,serif" font-size="14.00" text-anchor="middle" x="113.5" y="-272.3">459: on_strategy_start()</text>
<text style="display:none;">@classmethod
def on_strategy_start(cls, md, service, account):
    sErr = STRING_SUCCESS
    try:
        cls.time_python_platform_start = dt.now()
        cls.backtest = ktgfunc.backtesting()
        cls.initialize_default_parameters()
        cls.dir_path_log = DIR_PATH_LOG_THIS_APP
        cls.file_name_core_log = FILE_NAME_CORE_LOG
        cls.file_name_postfix = ''
        if cls.enable_debug_using_ktg_alert:
            cls.alert_guid_debug_ktg_alert = aktpdtrprm_plf.ALERT_GUID_000
            cls.list_message_field_id_debug_ktg_alert = [aktpdtrprm_plf.ALERT_FIELD_alert_type, aktpdtrprm_plf.ALERT_FIELD_alert_ID, aktpdtrprm_plf.ALERT_FIELD_alert_message]
        cls.tracer_0 = CTracer(service, cls.alert_guid_debug_ktg_alert, 3, cls.list_message_field_id_debug_ktg_alert, cls.dir_path_log, cls.file_name_core_log, cls.file_name_postfix, cls.backtest)
        cls.enable_alerter_0 = cls.enable_alerter_0_cfg
        cls.enable_alerter_1 = cls.enable_alerter_1_cfg
        cls.enable_alerter_2 = cls.enable_alerter_2_cfg
        cls.enable_alerter_3 = cls.enable_alerter_3_cfg
        cls.enable_alerter_this_script = cls.enable_alerter_this_script_cfg
        if not cls.create_alerters(service):
            pass
        system_information = sys.version
        msg = '\n this_script name = {p_this_script_name} \n script_version = {p_script_version} \n last_modified = {p_last_modified} \n algo_account_current = {p_algo_account_current} \n class_Strategy_GUID_current = {p_class_Strategy_GUID_current} \n python_sys_version = {p_python_sys_version} \n'.format(p_this_script_name=THIS_SCRIPT_NAME, p_script_version=SCRIPT_VERSION, p_last_modified=LAST_MODIFIED, p_algo_account_current=ALGO_ACCOUNT_CQ_CURRENT, p_class_Strategy_GUID_current=CLASS_STRATEGY_GUID_CURRENT, p_python_sys_version=system_information)
        cls.tracer_0.trace(SYMBOL_NONE, 'on_strategy_start', 'major script and platform parameters', msg)
        cls.list_symbol_universe_qualified = []
        if not cls.get_symbol_universe():
            pass
        cls.dict_trading_algorithm_params = {}
        if not cls.get_trading_algorithm_params():
            pass
        cls.dict_risk_management_algorithm_params = {}
        if not cls.get_risk_management_algorithm_params():
            pass
        cls.dict_trading_order_algorithm_params = {}
        if not cls.get_trading_order_algorithm_params():
            pass
        cls.set_VXX_proxy(service.system_time)
        cls.list_market_index.append('SPY')
        cls.list_market_index.append(cls.VXX_proxy)
    except Exception as X:
        sErr = STRING_FAILED
        msg = traceback.format_exc()
        cls.tracer_0.trace(SYMBOL_NONE, 'on_strategy_start', sErr, msg)
    finally:
        cls.tracer_0.trace(SYMBOL_NONE, 'on_strategy_start', sErr, LEXEM_FINALLY)</text></g>
<!-- node_bfd8e7f9&#45;&gt;node_e1f2033f -->
<g class="edge" id="edge27">
<title>node_bfd8e7f9-&gt;node_e1f2033f</title>
<path d="M186.66,-268.29C208.63,-268.29 227,-268.29 227,-268.29 227,-268.29 227,-150 227,-150 227,-150 327.28,-150 327.28,-150" fill="none" stroke="#e69f00" stroke-width="2"></path>
<polygon fill="#e69f00" points="327.28,-153.5 337.28,-150 327.28,-146.5 327.28,-153.5" stroke="#e69f00" stroke-width="2"></polygon>
</g>
<!-- node_bfd8e7f9&#45;&gt;node_267c6d6e -->
<g class="edge" id="edge28">
<title>node_bfd8e7f9-&gt;node_267c6d6e</title>
<path d="M186.65,-273.43C226.19,-273.43 267,-273.43 267,-273.43 267,-273.43 267,-232.24 267,-232.24" fill="none" stroke="#e69f00" stroke-width="2"></path>
<polygon fill="#e69f00" points="270.5,-232.24 267,-222.24 263.5,-232.24 270.5,-232.24" stroke="#e69f00" stroke-width="2"></polygon>
</g>
<!-- node_bfd8e7f9&#45;&gt;node_d552820d -->
<g class="edge" id="edge29">
<title>node_bfd8e7f9-&gt;node_d552820d</title>
<path d="M186.68,-278.57C186.68,-278.57 308.25,-278.57 308.25,-278.57" fill="none" stroke="#e69f00" stroke-width="2"></path>
<polygon fill="#e69f00" points="308.25,-282.07 318.25,-278.57 308.25,-275.07 308.25,-282.07" stroke="#e69f00" stroke-width="2"></polygon>
</g>
<!-- node_bfd8e7f9&#45;&gt;node_e2db408c -->
<g class="edge" id="edge30">
<title>node_bfd8e7f9-&gt;node_e2db408c</title>
<path d="M179,-294.09C179,-317.13 179,-354 179,-354 179,-354 282.89,-354 282.89,-354" fill="none" stroke="#e69f00" stroke-width="2"></path>
<polygon fill="#e69f00" points="282.89,-357.5 292.89,-354 282.89,-350.5 282.89,-357.5" stroke="#e69f00" stroke-width="2"></polygon>
</g>
<!-- node_bfd8e7f9&#45;&gt;node_b81e3d50 -->
<g class="edge" id="edge31">
<title>node_bfd8e7f9-&gt;node_b81e3d50</title>
<path d="M186.97,-283.71C231.97,-283.71 281,-283.71 281,-283.71 281,-283.71 281,-391.9 281,-391.9" fill="none" stroke="#e69f00" stroke-width="2"></path>
<polygon fill="#e69f00" points="277.5,-391.9 281,-401.9 284.5,-391.9 277.5,-391.9" stroke="#e69f00" stroke-width="2"></polygon>
</g>
<!-- node_bfd8e7f9&#45;&gt;node_1a15e40f -->
<g class="edge" id="edge32">
<title>node_bfd8e7f9-&gt;node_1a15e40f</title>
<path d="M171,-294.04C171,-345.96 171,-492 171,-492 171,-492 287.46,-492 287.46,-492" fill="none" stroke="#e69f00" stroke-width="2"></path>
<polygon fill="#e69f00" points="287.46,-495.5 297.46,-492 287.46,-488.5 287.46,-495.5" stroke="#e69f00" stroke-width="2"></polygon>
</g>
<!-- node_47ab69f2 -->
<g class="node" id="node34">
<title>node_47ab69f2</title>
<path d="M463,-114C463,-114 344,-114 344,-114 338,-114 332,-108 332,-102 332,-102 332,-90 332,-90 332,-84 338,-78 344,-78 344,-78 463,-78 463,-78 469,-78 475,-84 475,-90 475,-90 475,-102 475,-102 475,-108 469,-114 463,-114" fill="#6db33f" stroke="black"></path>
<text font-family="Times New Roman,serif" font-size="14.00" text-anchor="middle" x="403.5" y="-92.3">588: set_VXX_proxy()</text>
<text style="display:none;">@classmethod
def set_VXX_proxy(cls, timestamp_muts):
    datetime_simulation_UTC = dt.utcfromtimestamp(timestamp_muts / 1000000)
    year = datetime_simulation_UTC.year
    month = datetime_simulation_UTC.month
    day = datetime_simulation_UTC.day
    cls.VXX_proxy = 'VXX'
    if year == 2019:
        if month == 1 and 30 &lt;= day or month == 2 or month == 3 or (month == 4) or (month == 5 and day &lt; 2):
            cls.VXX_proxy = 'VXXB'</text></g>
<!-- node_bfd8e7f9&#45;&gt;node_47ab69f2 -->
<g class="edge" id="edge33">
<title>node_bfd8e7f9-&gt;node_47ab69f2</title>
<path d="M186.73,-263.14C202.73,-263.14 215,-263.14 215,-263.14 215,-263.14 215,-96 215,-96 215,-96 321.97,-96 321.97,-96" fill="none" stroke="#e69f00" stroke-width="2"></path>
<polygon fill="#e69f00" points="321.97,-99.5 331.97,-96 321.97,-92.5 321.97,-99.5" stroke="#e69f00" stroke-width="2"></polygon>
</g>
<!-- node_fb7f02f5&#45;&gt;node_3b3e14e3 -->
<g class="edge" id="edge34">
<title>node_fb7f02f5-&gt;node_3b3e14e3</title>
<path d="M458.77,-623.75C458.77,-623.75 719.19,-623.75 719.19,-623.75" fill="none" stroke="#0072b2" stroke-width="2"></path>
<polygon fill="#0072b2" points="719.19,-627.25 729.19,-623.75 719.19,-620.25 719.19,-627.25" stroke="#0072b2" stroke-width="2"></polygon>
</g>
<!-- node_fb7f02f5&#45;&gt;node_f9ead294 -->
<g class="edge" id="edge38">
<title>node_fb7f02f5-&gt;node_f9ead294</title>
<path d="M458.75,-633.25C512.47,-633.25 586,-633.25 586,-633.25 586,-633.25 586,-682.5 586,-682.5 586,-682.5 719.75,-682.5 719.75,-682.5" fill="none" stroke="#0072b2" stroke-width="2"></path>
<polygon fill="#0072b2" points="719.75,-686 729.75,-682.5 719.75,-679 719.75,-686" stroke="#0072b2" stroke-width="2"></polygon>
</g>
<!-- node_fb7f02f5&#45;&gt;node_d0b12c38 -->
<g class="edge" id="edge42">
<title>node_fb7f02f5-&gt;node_d0b12c38</title>
<path d="M458.64,-628.5C548.84,-628.5 718,-628.5 718,-628.5 718,-628.5 718,-719.85 718,-719.85" fill="none" stroke="#0072b2" stroke-width="2"></path>
<polygon fill="#0072b2" points="714.5,-719.85 718,-729.85 721.5,-719.85 714.5,-719.85" stroke="#0072b2" stroke-width="2"></polygon>
</g>
<!-- node_fb7f02f5&#45;&gt;node_7b0a0283 -->
<g class="edge" id="edge43">
<title>node_fb7f02f5-&gt;node_7b0a0283</title>
<path d="M458.6,-610.5C550.23,-610.5 724,-610.5 724,-610.5 724,-610.5 724,-609.57 724,-609.57" fill="none" stroke="#0072b2" stroke-width="2"></path>
<polygon fill="#0072b2" points="727.5,-611.19 724,-601.19 720.5,-611.19 727.5,-611.19" stroke="#0072b2" stroke-width="2"></polygon>
</g>
<!-- node_96683333 -->
<g class="node" id="node32">
<title>node_96683333</title>
<path d="M445,-800C445,-800 362,-800 362,-800 356,-800 350,-794 350,-788 350,-788 350,-776 350,-776 350,-770 356,-764 362,-764 362,-764 445,-764 445,-764 451,-764 457,-770 457,-776 457,-776 457,-788 457,-788 457,-794 451,-800 445,-800" fill="#966f33" stroke="black"></path>
<text font-family="Times New Roman,serif" font-size="14.00" text-anchor="middle" x="403.5" y="-778.3">1850: on_trade()</text>
<text style="display:none;">def on_trade(self, event, md, order, service, account):
    sErr = STRING_SUCCESS
    try:
        self.price = md.L1.last
        if self.is_order_buy_init_filled or self.is_order_sell_init_filled or self.is_order_buy_increase_filled or self.is_order_sell_increase_filled:
            if self.stop_price_trail_base_type == aktpdtrprm.STOP_PRICE_TRAIL_BASE_TYPE_LAST_PRICE:
                self.price_stop_trail_base = self.price
            elif self.stop_price_trail_base_type == aktpdtrprm.STOP_PRICE_TRAIL_BASE_TYPE_HIGH_PRICE_SINCE_ON_FILL:
                if self.price &gt; self.price_high_day_since_on_fill:
                    self.price_high_day_since_on_fill = self.price
                self.price_stop_trail_base = self.price_high_day_since_on_fill
            else:
                self.price_stop_trail_base = self.price
        if self.is_order_buy_init_filled or self.is_order_buy_increase_filled:
            if self.is_stop_price_down_buy_set:
                if self.price &lt; self.stop_price_down_buy:
                    if account[self.symbol].position.shares &gt; 0:
                        self.algo_sell_exit(md, order, service, account)
                        if type(self).enable_log_trade_exit_params_per_symbol_cfg:
                            msg = 'self.price &lt; self.stop_price_down_buy'
                            type(self).tracer_0.trace(md.symbol, 'on_trade', 'algo_sell_exit', msg)
                elif self.price &gt; self.stop_price_down_buy:
                    if self.stop_price_trail_type == aktpdtrprm.STOP_PRICE_TRAIL_TYPE_CONTINUOUS:
                        stop_price_down_buy_new = self.price - self.price_stop_trail_base * self.stop_price_trail_interval_coeff_down_buy
                        if stop_price_down_buy_new &gt; self.stop_price_down_buy:
                            self.stop_price_down_buy = stop_price_down_buy_new
                    if self.stop_price_trail_type == aktpdtrprm.STOP_PRICE_TRAIL_TYPE_STEP:
                        if self.price &gt; self.stop_price_trail_threshold_buy:
                            if self.stop_price_trail_step_buy_count &lt; self.stop_price_trail_step_count_max_down_buy:
                                self.stop_price_down_buy += self.stop_price_trail_step_interval_coeff_down_buy
                                self.stop_price_trail_threshold_buy += self.stop_price_trail_step_interval_coeff_down_buy
                                self.stop_price_trail_step_buy_count += 1
                else:
                    pass
            if self.price &gt; self.price_target_buy:
                if account[self.symbol].position.shares &gt; 0:
                    self.algo_sell_exit(md, order, service, account)
                    if type(self).enable_log_trade_exit_params_per_symbol_cfg:
                        msg = 'self.price &gt; self.price_target_buy'
                        type(self).tracer_0.trace(md.symbol, 'on_trade', 'algo_sell_exit', msg)
            if md.L1.timestamp &gt; self.time_stop_trade_buy_on_fill_reference:
                if account[self.symbol].position.shares &gt; 0:
                    self.algo_sell_exit(md, order, service, account)
                    if type(self).enable_log_trade_exit_params_per_symbol_cfg:
                        msg = 'md.L1.timestamp &gt; self.time_stop_trade_buy_on_fill_reference'
                        type(self).tracer_0.trace(md.symbol, 'on_trade', 'algo_sell_exit', msg)
        elif self.is_order_sell_init_filled or self.is_order_sell_increase_filled:
            if self.is_stop_price_up_sell_set:
                if self.price &gt; self.stop_price_up_sell:
                    if account[self.symbol].position.shares &lt; 0:
                        self.algo_buy_exit(md, order, service, account)
                        if type(self).enable_log_trade_exit_params_per_symbol_cfg:
                            msg = 'self.price &gt; self.stop_price_up_sell'
                            type(self).tracer_0.trace(md.symbol, 'on_trade', 'algo_buy_exit', msg)
                elif self.price &lt; self.stop_price_up_sell:
                    if self.stop_price_trail_type == aktpdtrprm.STOP_PRICE_TRAIL_TYPE_CONTINUOUS:
                        stop_price_up_sell_new = self.price + self.price_stop_trail_base * self.stop_price_trail_interval_coeff_up_sell
                        if stop_price_up_sell_new &lt; self.stop_price_up_sell:
                            self.stop_price_up_sell = stop_price_up_sell_new
                    if self.stop_price_trail_type == aktpdtrprm.STOP_PRICE_TRAIL_TYPE_STEP:
                        if self.price &lt; self.stop_price_trail_threshold_sell:
                            if self.stop_price_trail_step_sell_count &lt; self.stop_price_trail_step_count_max_up_sell:
                                self.stop_price_up_sell -= self.stop_price_trail_step_interval_coeff_up_sell
                                self.stop_price_trail_threshold_sell -= self.stop_price_trail_step_interval_coeff_up_sell
                                self.stop_price_trail_step_sell_count += 1
                else:
                    pass
            if self.price &lt; self.price_target_sell:
                if account[self.symbol].position.shares &lt; 0:
                    self.algo_buy_exit(md, order, service, account)
                    if type(self).enable_log_trade_exit_params_per_symbol_cfg:
                        msg = 'self.price &lt; self.price_target_sell'
                        type(self).tracer_0.trace(md.symbol, 'on_trade', 'algo_buy_exit', msg)
            if md.L1.timestamp &gt; self.time_stop_trade_sell_on_fill_reference:
                if account[self.symbol].position.shares &lt; 0:
                    self.algo_buy_exit(md, order, service, account)
                    if type(self).enable_log_trade_exit_params_per_symbol_cfg:
                        msg = 'md.L1.timestamp &gt; self.time_stop_trade_sell_on_fill_reference'
                        type(self).tracer_0.trace(md.symbol, 'on_trade', 'algo_buy_exit', msg)
        if account[md.symbol].position.shares == 0:
            if account[md.symbol].pending.shares_long == 0:
                if self.is_order_buy_decrease_filled:
                    if self.order_id_buy_decrease != '':
                        self.initialize_order_long()
            if account[md.symbol].pending.shares_short == 0:
                if self.is_order_sell_decrease_filled:
                    if self.order_id_sell_decrease != '':
                        self.initialize_order_short()
        elif md.L1.timestamp &gt; self.time_exit_trade_all:
            if account[self.symbol].position.shares &gt; 0:
                self.algo_sell_exit(md, order, service, account)
                if type(self).enable_log_trade_exit_params_per_symbol_cfg:
                    msg = 'md.L1.timestamp &gt; self.time_exit_trade_all'
                    type(self).tracer_0.trace(md.symbol, 'on_trade', 'algo_sell_exit', msg)
            if account[self.symbol].position.shares &lt; 0:
                self.algo_buy_exit(md, order, service, account)
                if type(self).enable_log_trade_exit_params_per_symbol_cfg:
                    msg = ' md.L1.timestamp &gt; self.time_exit_trade_all'
                    type(self).tracer_0.trace(md.symbol, 'on_trade', 'algo_buy_exit', msg)
    except Exception as X:
        sErr = STRING_FAILED
        msg = traceback.format_exc()
        type(self).tracer_0.trace(md.symbol, 'on_trade', sErr, msg)</text></g>
<!-- node_96683333&#45;&gt;node_3b3e14e3 -->
<g class="edge" id="edge44">
<title>node_96683333-&gt;node_3b3e14e3</title>
<path d="M457.36,-775C502.63,-775 560,-775 560,-775 560,-775 560,-646.5 560,-646.5 560,-646.5 719.48,-646.5 719.48,-646.5" fill="none" stroke="#009e73" stroke-width="2"></path>
<polygon fill="#009e73" points="719.48,-650 729.48,-646.5 719.48,-643 719.48,-650" stroke="#009e73" stroke-width="2"></polygon>
</g>
<!-- node_96683333&#45;&gt;node_f9ead294 -->
<g class="edge" id="edge48">
<title>node_96683333-&gt;node_f9ead294</title>
<path d="M457.39,-779.5C504.02,-779.5 564,-779.5 564,-779.5 564,-779.5 564,-700.5 564,-700.5 564,-700.5 719.69,-700.5 719.69,-700.5" fill="none" stroke="#009e73" stroke-width="2"></path>
<polygon fill="#009e73" points="719.69,-704 729.69,-700.5 719.69,-697 719.69,-704" stroke="#009e73" stroke-width="2"></polygon>
</g>
<!-- node_96683333&#45;&gt;node_d0b12c38 -->
<g class="edge" id="edge52">
<title>node_96683333-&gt;node_d0b12c38</title>
<path d="M404,-763.81C404,-760.46 404,-758 404,-758 404,-758 701.05,-758 701.05,-758" fill="none" stroke="#009e73" stroke-width="2"></path>
<polygon fill="#009e73" points="701.05,-761.5 711.05,-758 701.05,-754.5 701.05,-761.5" stroke="#009e73" stroke-width="2"></polygon>
</g>
<!-- node_96683333&#45;&gt;node_7b0a0283 -->
<g class="edge" id="edge53">
<title>node_96683333-&gt;node_7b0a0283</title>
<path d="M457.34,-770.5C500.89,-770.5 555,-770.5 555,-770.5 555,-770.5 555,-589 555,-589 555,-589 699.93,-589 699.93,-589" fill="none" stroke="#009e73" stroke-width="2"></path>
<polygon fill="#009e73" points="699.93,-592.5 709.93,-589 699.93,-585.5 699.93,-592.5" stroke="#009e73" stroke-width="2"></polygon>
</g>
<!-- node_48e3497a -->
<g class="node" id="node33">
<title>node_48e3497a</title>
<path d="M191,-168C191,-168 36,-168 36,-168 30,-168 24,-162 24,-156 24,-156 24,-144 24,-144 24,-138 30,-132 36,-132 36,-132 191,-132 191,-132 197,-132 203,-138 203,-144 203,-144 203,-156 203,-156 203,-162 197,-168 191,-168" fill="#966f33" stroke="black"></path>
<text font-family="Times New Roman,serif" font-size="14.00" text-anchor="middle" x="113.5" y="-146.3">578: register_event_streams()</text>
<text style="display:none;">@classmethod
def register_event_streams(cls, md, service, account):
    return {'!sma': self.on_dev_evt()}</text></g>
<!-- node_48e3497a&#45;&gt;node_6279df72 -->
<g class="edge" id="edge54">
<title>node_48e3497a-&gt;node_6279df72</title>
<path d="M199,-131.68C199,-100.87 199,-42 199,-42 199,-42 331.87,-42 331.87,-42" fill="none" stroke="#56b4e9" stroke-width="2"></path>
<polygon fill="#56b4e9" points="331.87,-45.5 341.87,-42 331.87,-38.5 331.87,-45.5" stroke="#56b4e9" stroke-width="2"></polygon>
</g>
</g>
</svg>
`,
                    ready: function() {
                        var gv = this
                        gv.nodes().on('dblclick', function () {
                            var nodeData = this.textContent.split(":");
                            var lineToJump = parseInt(nodeData[0], 10);
                            var funcName = nodeData[1];
                            var newWindow = window.open('', '_blank');
                            var data = this.getElementsByTagName('text');
                            if (data.length == 2){
                                data = data[1].textContent;
                            }else{
                                data = "Could not find function...";
                            }
                            var lines = data.split('\n');
                            // Generate the HTML content with line numbers
                            var content = '';
                            for (var i = 0; i < lines.length; i++) {
                                var lineNumber = i+1;
                                content += '<div style="' + (lineNumber === lineToJump ? 'background-color: yellow;' : '') + '"><span class="line-number">' + "    " + '</span>' + lines[i] + '</div>';
                            }
                            // Write content to new window
                            newWindow.document.open();
                            newWindow.document.write('<pre><code class="python">' + content + '</code></pre>');
                            newWindow.document.close()
                            var codeElements = newWindow.document.querySelectorAll('pre code');
                            codeElements.forEach(function(element) {
                                hljs.highlightBlock(element);
                            });

                            hljs.initHighlightingOnLoad();
                                // Calculate the line height
                            var lineHeight = calculateLineHeight(newWindow);
                            var scrollToPixel = Math.ceil(lineHeight * (lineToJump));
                            newWindow.scrollTo(0, scrollToPixel);

                        });
                        gv.nodes().click(function () {
                            var $set = $()
                            $set.push(this)
                            $set = $set.add(gv.linkedFrom(this, true))
                            $set = $set.add(gv.linkedTo(this, true))
                            gv.highlight($set, true)
                            gv.bringToFront($set)
                        })
                        $(document).keydown(function (evt) {
                            if (evt.keyCode == 27) {
                                gv.highlight(this, false)
                            }
                        })
                    }
                });
            });
		</script>
	</body>
</html>